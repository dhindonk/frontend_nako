<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NakoClass_Huda Sense</title>

    <link rel="stylesheet" href="style.css">
    <style>
        .body-content-small {
            position: relative;
            width: 100%;
            height: max-content;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(100px);
            background: var(--color-shadow);
        }

        .body-content-small.v2 {
            padding-top: 150px;
            background: var(--color-shadow) !important;
        }

        .body-content-small .section-title {
            position: relative;
            width: 100%;
            text-align: center;
            color: var(--color-white);
            font-family: var(--font-family-style);
        }

        .body-content-small .section-title h2 {
            font-size: clamp(2rem, 3vw, 4rem);
            font-weight: 700;
            margin: 0;
            text-shadow: 2px 2px 20px rgba(0, 0, 0, 0.3);
            letter-spacing: 2px;
        }

        .body-content-small .section-title p {
            font-size: clamp(1.2rem, 1.5vw, 2rem);
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-weight: 300;
        }

        .horizontal-scroll-section {
            position: relative;
            height: 100vh;
            overflow: hidden;
            background: var(--color-shadow);
            display: flex;
            align-items: start;
            flex-direction: column;
        }

        .horizontal-scroll-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: var(--color-shadow);
        }

        .cards-container {
            display: flex;
            align-items: center;
            height: 100vh;
            width: max-content;
            padding: 0 100px;
            gap: 60px;
        }

        .tutorial-card {
            flex-shrink: 0;
            width: 340px;
            /* width: 380px; */
            height: 480px;
            /* background: rgba(255, 255, 255, 0.95); */
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            cursor: pointer;
            transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card-img {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: relative;
        }

        .card-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: .6s ease;
        }

        .card-content {
            position: absolute;
            padding: 30px;
            min-height: 50%;
            height: max-content;
            bottom: 0;
            left: 0;
            z-index: 2;
            display: flex;
            backdrop-filter: blur(0);
            background: linear-gradient(to top,
                    var(--color-black-high) 20%,
                    rgba(0, 0, 0, 0.85) 40%,
                    rgba(0, 0, 0, 0.6) 60%,
                    rgba(0, 0, 0, 0.3) 80%,
                    rgba(0, 0, 0, 0) 100%);
            transition: .5s;
            flex-direction: column;
            justify-content: space-between;
        }

        .card-category {
            display: inline-block;
            padding: 6px 16px;
            background: var(--color-primary);
            color: var(--color-black-high);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            width: fit-content;
            box-shadow: rgba(99, 99, 99, 0.2) 0px 2px 8px 0px;
        }

        .card-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--color-white);
            margin: 0 0 12px 0;
            line-height: 1.3;
        }

        .card-description {
            font-size: 14px;
            color: var(--color-light);
            line-height: 1.6;
            margin: 0 0 20px 0;
            flex-grow: 1;
        }

        .progress-indicator {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 10;
        }

        .progress-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .progress-dot.active {
            width: 24px;
            border-radius: 50px;
            background: var(--color-primary);
        }

        .card-animate {
            opacity: 0;
            transform: translateX(100px) translateY(20px);
            filter: blur(10px);
        }

        .drawing-effect {
            position: relative;
            overflow: hidden;
        }

        .drawing-effect::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8), transparent);
            transition: left 0.8s ease;
            z-index: 1;
        }

        .drawing-effect.animate::before {
            left: 100%;
        }
    </style>
</head>

<body>

    <div class="background_custom">
        <div class="particles"></div>

        <div class="svg_body_bg">
            <div class="circle_lg">
                <!-- Fixed: Made viewBox square (797x797) to match width/height -->
                <svg width="797" height="797" viewBox="0 0 797 797" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g filter="url(#filter0_f_135_244)">
                        <circle cx="398.5" cy="398.5" r="181.958" fill="#FEE193" />
                    </g>
                    <defs>
                        <filter id="filter0_f_135_244" x="0" y="0" width="797" height="797" filterUnits="userSpaceOnUse"
                            color-interpolation-filters="sRGB">
                            <feFlood flood-opacity="0" result="BackgroundImageFix" />
                            <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape" />
                            <feGaussianBlur stdDeviation="108" result="effect1_foregroundBlur_135_244" />
                        </filter>
                    </defs>
                </svg>
            </div>

            <div class="circle_sm">
                <!-- Fixed: Made it a perfect circle by using same radius for both rx and ry -->
                <svg width="510" height="510" viewBox="0 0 510 510" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g filter="url(#filter0_f_135_246)">
                        <!-- Changed ellipse to circle with consistent radius -->
                        <circle cx="255" cy="255" r="130" fill="#B8E0D8" />
                    </g>
                    <defs>
                        <filter id="filter0_f_135_246" x="0" y="0" width="510" height="510" filterUnits="userSpaceOnUse"
                            color-interpolation-filters="sRGB">
                            <feFlood flood-opacity="0" result="BackgroundImageFix" />
                            <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape" />
                            <feGaussianBlur stdDeviation="60" result="effect1_foregroundBlur_135_246" />
                        </filter>
                    </defs>
                </svg>
            </div>
        </div>
    </div>

    <nav>
        <div class="logo">
            <a href="#">NakoClass</a>
        </div>
        <div class="nav-links">
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="#">Cara Menggambar</a></li>
                <li><a href="#">Referensi</a></li>
                <li><a href="#">Toko</a></li>
            </ul>
        </div>
        <div class="menu-toggle">
            <p id="menu-open">Menu</p>
            <p id="menu-close">Close</p>
        </div>
    </nav>

    <div class="menu-overlay">
        <div class="menu-content">
            <div class="menu-items">
                <div class="col-lg">
                    <div class="menu-preview-img">
                        <img src="4.png" alt="">
                    </div>
                </div>
                <div class="col-sm">
                    <div class="menu-links">
                        <div class="link">
                            <a href="#" data-img="1.jpg">Home</a>
                        </div>
                        <div class="link">
                            <a href="#" data-img="wp5.jpg">Cara Menggambar</a>
                        </div>
                        <div class="link">
                            <a href="#" data-img="wp6.jpg">Referensi</a>
                        </div>
                        <div class="link">
                            <a href="#" data-img="3.jpg">Toko</a>
                        </div>
                    </div>
                    <div class="menu-socials">
                        <div class="social">
                            <a href="#">Instagram</a>
                        </div>
                        <div class="social">
                            <a href="#">WhatsApp</a>
                        </div>
                        <div class="social">
                            <a href="#">LinkedIn</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="menu-footer">
                <div class="col-lg">
                    <a href="#">Testing</a>
                </div>
                <div class="col-sm">
                    <a href="#">Origin</a>
                    <a href="#">Join Signal</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Splashscreen -->
    <div class="splash_screen">
        <div class="splash-content">
            <span>N</span>
            <span>A</span>
            <span>K</span>
            <span>O</span>
            <span>C</span>
            <span>L</span>
            <span>A</span>
            <span>S</span>
            <span>S</span>
        </div>
        <div class="mask-text">
            <p class="japanese-text" id="japaneseText">ナコクラス</p>
        </div>
        <div class="splash_progress_wrapper">
            <div class="splash_progress_bar" id="splashProgressBar"></div>
        </div>
        <svg class="splash-svg" viewBox="0 0 1440 420" preserveAspectRatio="none" width="1440" height="420">
            <path id="curve" d="M0,0 Q820,820 1440,0 L1440,-280 L0,-280 Z" fill="var(--color-shadow)" />
        </svg>
    </div>

    <!-- Main Contant -->
    <div id="smooth-wrapper" class="container">

        <div id="smooth-content">

            <section id="home" class="hero">
                <div class="box-title">

                    <div class="title-top">
                        <h1 class="split-title">Master the art of drawing <br> Manga step by step</h1>
                    </div>
                    <div class="title-bottom" aria-hidden="true">
                        マンガの描き方を基本から上達まで学ぼう
                        <span class="underline"></span>
                    </div>
                </div>
            </section>

            <!-- content 1 -->
            <section class="body-content">
                <div class="box_tutor" data-video="video_1.webm">

                    <div class="box_text box_text_left">
                        <div class="box_title">
                            <span class="title">
                                Dasar Dasar Menggambar Manga
                            </span>
                        </div>
                        <div class="box_description">
                            <span class="description">
                                Mengenal alat dan teknik dasar dalam menggambar manga. Pelajari cara membuat garis yang
                                tepat
                                dan
                                penggunaan pensil yang benar
                            </span>
                        </div>
                        <div class="box_jpn">
                            <span class="jpn">
                                漫画の基本を学ぶ
                            </span>
                        </div>
                    </div>

                    <div class="box_img">
                        <div class="img_thum">
                            <video muted autoplay playsinline loop>
                                <source src="thumbnail.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="border_img">
                            <img src="images/border_frame.svg" alt="">
                        </div>
                        <div class="play_btn">
                        </div>
                        <div class="loading-spinner" style="display: none;"></div>
                    </div>
                    <div class="char_img char_right">
                        <img width="300" height="300" src="images/anime.png" alt="">
                    </div>
                </div>
            </section>

            <!-- content 2 -->
            <section class="body-content">
                <div class="box_tutor" data-video="thumbnail.mp4">

                    <div class="box_img">
                        <div class="img_thum">
                            <video muted autoplay playsinline loop>
                                <source src="thumbnail.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="border_img">
                            <img src="images/border_frame.svg" alt="">
                        </div>
                        <div class="play_btn">
                        </div>
                        <div class="loading-spinner" style="display: none;"></div>
                    </div>
                    <div class="char_img">
                        <img width="300" height="300" src="images/anime.png" alt="">
                    </div>
                    <div class="box_text">
                        <div class="box_title">
                            <span class="title">
                                Dasar Dasar Menggambar Manga
                            </span>
                        </div>
                        <div class="box_description">
                            <span class="description">
                                Mengenal alat dan teknik dasar dalam menggambar manga. Pelajari cara membuat garis yang
                                tepat
                                dan
                                penggunaan pensil yang benar
                            </span>
                        </div>
                        <div class="box_jpn">
                            <span class="jpn">
                                漫画の基本を学ぶ
                            </span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- content 3 -->
            <section class="body-content">
                <div class="box_tutor" data-video="video_1.webm">

                    <div class="box_text box_text_left">
                        <div class="box_title">
                            <span class="title">
                                Dasar Dasar Menggambar Manga
                            </span>
                        </div>
                        <div class="box_description">
                            <span class="description">
                                Mengenal alat dan teknik dasar dalam menggambar manga. Pelajari cara membuat garis yang
                                tepat
                                dan
                                penggunaan pensil yang benar
                            </span>
                        </div>
                        <div class="box_jpn">
                            <span class="jpn">
                                漫画の基本を学ぶ
                            </span>
                        </div>
                    </div>

                    <div class="box_img">
                        <div class="img_thum">
                            <video muted autoplay playsinline loop>
                                <source src="thumbnail.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="border_img">
                            <img src="images/border_frame.svg" alt="">
                        </div>
                        <div class="play_btn">
                        </div>
                        <div class="loading-spinner" style="display: none;"></div>
                    </div>
                    <div class="char_img char_right">
                        <img width="300" height="300" src="images/anime.png" alt="">
                    </div>
                </div>
            </section>

            <!-- content 4 -->
            <section class="body-content">
                <div class="box_tutor" data-video="thumbnail.mp4">

                    <div class="box_img">
                        <div class="img_thum">
                            <video muted autoplay playsinline loop>
                                <source src="thumbnail.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="border_img">
                            <img src="images/border_frame.svg" alt="">
                        </div>
                        <div class="play_btn">
                        </div>
                        <div class="loading-spinner" style="display: none;"></div>
                    </div>
                    <div class="char_img">
                        <img width="300" height="300" src="images/anime.png" alt="">
                    </div>
                    <div class="box_text">
                        <div class="box_title">
                            <span class="title">
                                Dasar Dasar Menggambar Manga
                            </span>
                        </div>
                        <div class="box_description">
                            <span class="description">
                                Mengenal alat dan teknik dasar dalam menggambar manga. Pelajari cara membuat garis yang
                                tepat
                                dan
                                penggunaan pensil yang benar
                            </span>
                        </div>
                        <div class="box_jpn">
                            <span class="jpn">
                                漫画の基本を学ぶ
                            </span>
                        </div>
                    </div>
                </div>
            </section>

            <div class="body-content-small">
                <div class="section-title study-title">
                    <div class="mask-text">
                        <h2>Pelajaran Disesuaikan untuk Anda</h2>
                    </div>
                    <div class="mask-text">
                        <p>Kumpulan hasil akhir proyek yang menampilkan detail, kualitas, dan kreativitas terbaik kami.
                        </p>
                    </div>
                </div>
            </div>

            <!-- content horizontal scroll -->
            <section class="horizontal-scroll-section">
                <div class="horizontal-scroll-wrapper">
                    <div class="cards-container">
                        <a href="#">
                            <div class="tutorial-card card-animate drawing-effect">
                                <div class="card-img">
                                    <img src="draw.png" alt="">
                                </div>
                                <div class="card-content">
                                    <span class="card-category">Dasar</span>
                                    <h3 class="card-title">Sketsa dan outline dasar dalam menggambar manga</h3>
                                    <p class="card-description">Lorem ipsum text saja soalnya contoh, kita bisa ubah
                                        nanti
                                        untuk keperluan content yang lain.</p>
                                </div>
                            </div>
                        </a>

                        <a href="#">
                            <div class="tutorial-card card-animate drawing-effect">
                                <div class="card-img">
                                    <img src="draw.png" alt="">
                                </div>
                                <div class="card-content">
                                    <span class="card-category">Menengah</span>
                                    <h3 class="card-title">Teknik pewarnaan dan shading professional</h3>
                                    <p class="card-description">Pelajari teknik pewarnaan digital dan traditional yang
                                        digunakan mangaka profesional.</p>
                                </div>
                            </div>
                        </a>

                        <a href="#">
                            <div class="tutorial-card card-animate drawing-effect">
                                <div class="card-img">
                                    <img src="draw.png" alt="">
                                </div>
                                <div class="card-content">
                                    <span class="card-category">Lanjutan</span>
                                    <h3 class="card-title">Komposisi panel dan storytelling</h3>
                                    <p class="card-description">Menguasai seni bercerita melalui komposisi panel yang
                                        dinamis dan menarik.</p>
                                </div>
                            </div>
                        </a>

                        <a href="#">
                            <div class="tutorial-card card-animate drawing-effect">
                                <div class="card-img">
                                    <img src="draw.png" alt="">
                                </div>
                                <div class="card-content">
                                    <span class="card-category">Khusus</span>
                                    <h3 class="card-title">Karakter design dan development</h3>
                                    <p class="card-description">Ciptakan karakter yang memorable dengan personality dan
                                        design yang kuat.</p>
                                </div>
                            </div>
                        </a>

                        <a href="#">
                            <div class="tutorial-card card-animate drawing-effect">
                                <div class="card-img">
                                    <img src="draw.png" alt="">
                                </div>
                                <div class="card-content">
                                    <span class="card-category">Pro</span>
                                    <h3 class="card-title">Digital workflow dan publishing</h3>
                                    <p class="card-description">Pelajari workflow professional untuk digital manga dan
                                        persiapan publishing.</p>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>

                <div class="progress-indicator">
                    <div class="progress-dot active"></div>
                    <div class="progress-dot"></div>
                    <div class="progress-dot"></div>
                    <div class="progress-dot"></div>
                    <div class="progress-dot"></div>
                </div>
            </section>

            <div class="body-content-small v2">
                <div class="section-title gallery-title">
                    <div class="mask-text">
                        <h2>Gallery</h2>
                    </div>
                    <div class="mask-text">
                        <p>Kumpulan hasil akhir proyek yang menampilkan detail, kualitas, dan kreativitas terbaik kami.
                        </p>
                    </div>
                </div>
            </div>

            <!-- content gallery section -->
            <div class="body-content gradient-gallery">
                <section class="gallery-section" id="gallery-section">
                    <div class="gallery-grid-box">
                        <div class="gallery-grid-padding">
                            <div id="gallery-grid-container"></div>
                            <div class="nav-hint" id="navHint">
                                Drag to explore • Scroll to navigate • Click to view
                            </div>
                        </div>
                    </div>
                </section>
                <div id="gallery-modal-overlay">
                    <div id="gallery-modal-content">
                        <img id="gallery-modal-image" src="" alt="Gallery Image">
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer class="footer">
                <div class="footer-container">
                    <div class="footer-section">
                        <h3><span class="mask-text">FOLLOW US</span></h3>
                        <ul>
                            <li><a href="#"><span class="link-text">Instagram</span></a></li>
                            <li><a href="#"><span class="link-text">Discord</span></a></li>
                            <li><a href="#"><span class="link-text">Facebook</span></a></li>
                            <li><a href="#"><span class="link-text">Twitter</span></a></li>
                        </ul>
                    </div>

                    <div class="footer-section">
                        <h3><span class="mask-text">NAVIGATION</span></h3>
                        <ul>
                            <li><a href="#"><span class="link-text">Home</span></a></li>
                            <li><a href="#"><span class="link-text">Cara menggambar</span></a></li>
                            <li><a href="#"><span class="link-text">Referensi</span></a></li>
                            <li><a href="#"><span class="link-text">Toko</span></a></li>
                        </ul>
                    </div>

                    <div class="nakoclass-section">
                        <h1 class="nakoclass-title">
                            <span class="mask-text">NakoClass</span>
                        </h1>
                        <p class="nakoclass-subtitle">
                            <span class="mask-text">Platform pembelajaran manga terbaik</span><br>
                            <span class="mask-text">di Indonesia</span>
                        </p>
                    </div>

                    <div class="footer-bottom">
                        <p><span class="bottom-text">Make with <span class="heart">❤</span> 2025</span></p>
                    </div>
                </div>
            </footer>

            <section class="video-modal-overlay" id="videoModal">
                <div class="video-modal-container" id="videoContainer">
                    <button class="close-btn" id="closeBtn"></button>
                    <div class="video-wrapper">
                        <video id="mainVideo" playsinline>
                            <source src="" type="video/webm">
                            <source src="" type="video/mp4">
                        </video>
                        <div class="video-controls">
                            <button class="control-btn" id="playPauseBtn">
                                <span class="tooltip">Play/Pause</span>
                                ▶
                            </button>
                            <div class="progress-bar" id="progressBar">
                                <div class="progress-bar-fill" id="progressFill"></div>
                            </div>
                            <button class="control-btn" id="muteBtn">
                                <span class="tooltip">Mute/Unmute</span>
                                🔊
                            </button>
                            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.1"
                                value="1">
                            <button class="control-btn" id="fullscreenBtn">
                                <span class="tooltip">Fullscreen</span>
                                ⛶
                            </button>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/CustomEase.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollSmoother.min.js"
        integrity="sha512-t4hwZimhnCKT3YLAsEcAcRDkngVFfCcUIfNLIjklrIZAZKD+GfQMP7HbRcsVHxNS48WRBSywNU1uSM2zzLQt1Q=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/Draggable.min.js"
        integrity="sha512-dgqdovLK5r/NMiV5YfWA0xC94DKGrm+6q1OZpuWHm+uBGLTck6wu58WAX9lmy8wec6cVnsgxbPJ60DtmNFnfgg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/InertiaPlugin.min.js"
        integrity="sha512-PEhxb+AivyFXL3zZnE/TwS4sgWRDZRF7aTGVGkiF7ej++sMKTtN+ZfrEo8lPxrfMIOws/1RkVc1Apua29ktRwg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/SplitText.min.js"
        integrity="sha512-wOeEC+9qERAzhliwBFPDb6t8TiFFxdxG8vhK/Ygs7TuC44bpg8pg/X2/U/u+0X4fK05wb9id1EIipnF02+CFQw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
        gsap.registerPlugin(CustomEase, SplitText, ScrollSmoother, ScrollTrigger, Draggable, InertiaPlugin);
        CustomEase.create("fastSlow", "M0,0 C0.83,0 0.17,1 1,1");

        document.addEventListener("DOMContentLoaded", () => {
            new MainScript();
        });

        class MainScript {
            constructor() {
                this.init();
            }

            init() {
                new CoreScript();
                new AnimatedVariant();
                new AdvancedVideoPlayer();
                new ScrollAnimationManager();
                new HorizontalScrollSlider();
                new GalleryImage();
            }
        }

        class AssetPreloader {
            constructor() {
                this.assetUrls = [];
                this.totalAssets = 0;
                this.loadedAssets = 0;
                this.onProgress = null;
            }

            _discoverAssets() {
                const discoveredUrls = new Set();

                // 1. Gambar dari <img> dan <source>
                document.querySelectorAll('img[src], source[srcset]').forEach(el => {
                    const src = el.src || el.srcset;
                    if (src) discoveredUrls.add(src);
                });

                // 2. Gambar dari atribut data-img
                document.querySelectorAll('[data-img]').forEach(el => discoveredUrls.add(el.dataset.img));

                // 3. Video dari <video> dan <source>
                document.querySelectorAll('video, video source').forEach(el => {
                    if (el.src) discoveredUrls.add(el.src);
                });

                // 4. Video dari atribut data-video
                document.querySelectorAll('[data-video]').forEach(el => discoveredUrls.add(el.dataset.video));

                const manualAssets = [
                    'images/border_frame.svg',
                    'images/anime_1.webp',
                    'images/anime_2.png',
                    'images/anime_3.jpg',
                    'images/anime_4.jpg',
                    'images/anime_5.jpg',
                ];
                manualAssets.forEach(url => discoveredUrls.add(url));

                this.assetUrls = Array.from(discoveredUrls);
                this.totalAssets = this.assetUrls.length + 1;
            }

            _loadImage(src) {
                return new Promise((resolve) => {
                    const img = new Image();
                    img.src = src;
                    img.onload = () => resolve({ src, status: 'ok' });
                    img.onerror = () => resolve({ src, status: 'error' });
                });
            }

            _loadVideo(src) {
                return new Promise((resolve) => {
                    const video = document.createElement('video');
                    video.src = src;
                    video.oncanplaythrough = () => resolve({ src, status: 'ok' });
                    video.onerror = () => resolve({ src, status: 'error' });
                });
            }

            preload(onProgressCallback) {
                this.onProgress = onProgressCallback;
                this._discoverAssets();

                const promises = [];

                const fontPromise = document.fonts.ready.then(() => {
                    this._updateProgress();
                    return { src: 'fonts', status: 'ok' };
                });
                promises.push(fontPromise);

                this.assetUrls.forEach(url => {
                    let promise;
                    if (/\.(jpg|jpeg|png|gif|svg|webp)$/i.test(url)) {
                        promise = this._loadImage(url);
                    } else if (/\.(mp4|webm|ogg)$/i.test(url)) {
                        promise = this._loadVideo(url);
                    }

                    if (promise) {
                        promises.push(promise.then(result => {
                            this._updateProgress();
                            return result;
                        }));
                    } else {
                        this.totalAssets--;
                    }
                });

                this._updateProgress();
                return Promise.allSettled(promises);
            }

            _updateProgress() {
                if (this.onProgress) {
                    const percentage = this.totalAssets > 0 ? (this.loadedAssets / this.totalAssets) * 100 : 100;
                    this.onProgress(percentage);
                }
                this.loadedAssets++;
            }
        }

        //    SplashscreenManager
        class SplashscreenManager {
            constructor() {
                this.splashScreen = document.querySelector('.splash_screen');
                this.progressBar = document.getElementById('splashProgressBar');
                this.textSpans = document.querySelectorAll('.splash-content span');
                this.textJpn = document.getElementById('japaneseText');
                this.curve = document.getElementById('curve');
            }

            show() {
                return new Promise(resolve => {
                    const tl = gsap.timeline({
                        onComplete: resolve
                    });

                    tl.to(this.textSpans, {
                        y: "0%",
                        opacity: 1,
                        delay: 0.4,
                        duration: .8,
                        stagger: 0.05,
                        ease: "power3.out",
                    }).to(this.textJpn, {
                        y: "0%",
                        opacity: 1,
                        duration: .8,
                        ease: "power3.out",
                    }, "<");
                });
            }

            updateProgress(percentage) {
                if (this.progressBar) {
                    this.progressBar.style.width = `${percentage}%`;
                }
            }

            hide() {
                const tl = gsap.timeline({
                    onComplete: () => {
                        if (this.splashScreen) {
                            this.splashScreen.style.display = 'none';
                        }
                        document.body.style.overflow = 'auto';
                        ScrollSmoother.get()?.paused(false);
                    }
                });

                tl.to(this.splashScreen, {
                    duration: 1,
                    y: '-100%',
                    ease: 'power2.inOut',
                })
                    .to(this.curve, {
                        duration: .8,
                        ease: "power4.inOut",
                        attr: { d: "M0,0 Q820,0 1440,0 L1440,-280 L0,-280 Z" },
                    }, "<0.2");

                return tl;
            }
        }

        // CoreScript
        class CoreScript {
            constructor() {
                this.smoother = null;
                this.init();
            }

            async init() {
                this.smoother = ScrollSmoother.create({
                    wrapper: "#smooth-wrapper",
                    content: "#smooth-content",
                    smooth: 2.2,
                    effects: true,
                    smoothTouch: 0.1,
                    normalizeScroll: true,
                    ignoreMobileResize: true,
                });

                gsap.set("#smooth-wrapper", { autoAlpha: 0 }); // autoAlpha = visibility:hidden & opacity:0
                // =======================================================================

                this.smoother.paused(true);
                document.body.style.overflow = 'hidden';

                const splashscreenManager = new SplashscreenManager();
                const assetPreloader = new AssetPreloader();

                const introAnimationPromise = splashscreenManager.show();
                const assetsLoadedPromise = assetPreloader.preload((percentage) => {
                    splashscreenManager.updateProgress(percentage);
                    console.log(`Loading... ${Math.round(percentage)}%`);
                });

                console.log("Waiting for assets AND intro animation to complete...");

                await Promise.all([introAnimationPromise, assetsLoadedPromise]);

                console.log("Assets loaded and intro animation finished. Starting main transition.");
                // =====================================================================

                const masterTransition = gsap.timeline();

                masterTransition.to("#smooth-wrapper", { autoAlpha: 1, duration: 0.5 });

                masterTransition.add(splashscreenManager.hide(), "<") // 
                    .add(this.startMainContentAnimations(), "<0.5");
            }

            startMainContentAnimations() {
                const tl = gsap.timeline();

                const navLogo = document.querySelector(".logo a");
                const navLinks = document.querySelectorAll(".nav-links ul li");
                const textElement = document.querySelector(".split-title");
                const titleBottomElement = document.querySelector(".title-bottom");

                const split = textElement ? SplitText.create(textElement, { type: "chars,words,lines" }) : null;
                const splitDesc = titleBottomElement ? SplitText.create(titleBottomElement, { type: "words", aria: "hidden" }) : null;

                tl.from(navLogo, { y: -30, opacity: 0, duration: 1 })
                    .from(navLinks, { y: -30, opacity: 0, duration: 1, stagger: .1 }, "<");

                if (split && split.words) {
                    tl.from(split.words, {
                        y: -100,
                        opacity: 0,
                        rotation: "random(-50, 50)",
                        duration: 0.7,
                        ease: "back",
                        stagger: 0.1
                    }, 0.2);
                }
                if (splitDesc && splitDesc.words) {
                    tl.from(splitDesc.words, {
                        opacity: 0,
                        duration: 1,
                        ease: "sine.out",
                        stagger: 0.1,
                    }, "-=0.5");
                }
                tl.fromTo(".underline", { width: '0%' }, {
                    width: '70%',
                    duration: 1.2,
                    ease: "power2.inOut"
                }, "<");

                return tl;
            }

            getSmoother() {
                return this.smoother;
            }
        }

        // Animated Variant
        class AnimatedVariant {
            constructor() {
                this.initAnimations();
            }
            initAnimations() {

                // Background Animation
                const movementRadius = 120;

                function randomInRange(min, max) {
                    return Math.random() * (max - min) + min;
                }

                function animateCircle(selector, baseScale = 0.8, delay = 0) {
                    function move() {
                        const x = randomInRange(-movementRadius, movementRadius);
                        const y = randomInRange(-movementRadius, movementRadius);
                        // Fixed: Use consistent scale range that maintains circle shape
                        const scale = randomInRange(baseScale * 0.9, baseScale * 1.1);

                        gsap.to(selector, {
                            duration: 2,
                            x,
                            y,
                            scale: scale, // Single scale value maintains perfect circle
                            ease: "sine.inOut",
                            onComplete: move,
                            delay
                        });
                    }
                    move();
                }

                // Large circle animation with more stable scaling
                animateCircle(".circle_lg", 0.6);

                // Small circle animation with delay
                animateCircle(".circle_sm", 0.5, 0.2);

                // Navigation Bar Animation
                ScrollTrigger.create({
                    trigger: "body",
                    start: "top -100px",
                    end: "bottom bottom",
                    onEnter: () => {
                        // NavLinks hilang 
                        gsap.to(".nav-links", {
                            clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)",
                            duration: 0.5,
                            ease: "power2.in",
                            onComplete: () => {
                                gsap.set(".nav-links", { display: "none" });
                            }
                        });

                        // MenuToggle 
                        gsap.set(".menu-toggle", {
                            display: "block",
                            delay: 0.5,
                            clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)"
                        });
                        gsap.to(".menu-toggle", {
                            clipPath: "polygon(0 0, 100% 0, 100% 100%, 0 100%)",
                            opacity: 1,
                            duration: 0.6,
                            ease: "power3.out",
                            delay: 0.8
                        });
                    },
                    onLeaveBack: () => {
                        // MenuToggle hilang
                        gsap.to(".menu-toggle", {
                            clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)",
                            opacity: 0,
                            duration: 0.5,
                            ease: "power2.in",
                            onComplete: () => {
                                gsap.set(".menu-toggle", { display: "none" });
                            }
                        });

                        // NavLinks muncul kembali dengan clip-path
                        gsap.set(".nav-links", {
                            display: "block",
                            delay: 0.5,
                            clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)"
                        });
                        gsap.to(".nav-links", {
                            clipPath: "polygon(0 0, 100% 0, 100% 100%, 0 100%)",
                            duration: 0.6,
                            ease: "power3.out",
                            delay: 0.8
                        });
                    }
                });

                // Navigation Menu
                const container = document.querySelector(".container");
                const menuToggle = document.querySelector(".menu-toggle");
                const menuOverlay = document.querySelector(".menu-overlay");
                const menuContent = document.querySelector(".menu-content");
                const menuPreviewImg = document.querySelector(".menu-preview-img");
                const menuLinks = document.querySelectorAll(".link a");
                const navLinks = document.querySelectorAll(".nav-links a");

                let isOpen = false;
                let isAnimating = false;

                menuToggle.addEventListener("click", () => {
                    if (!isOpen) openMenu();
                    else closeMenu();
                });

                function cleanupPreviewImage() {
                    const previewImages = menuPreviewImg.querySelectorAll("img");
                    if (previewImages.length > 3) {
                        for (let i = 0; i < previewImages.length - 3; i++) {
                            menuPreviewImg.removeChild(previewImages[i]);
                        }
                    }
                }

                function resetPreviewImage() {
                    menuPreviewImg.innerHTML = '';
                    const defaultImage = document.createElement("img");
                    defaultImage.src = "https://picsum.photos/600/800?random=1";
                    menuPreviewImg.appendChild(defaultImage);
                }

                function animateMenuToggle(isOpening) {
                    const open = document.querySelector("#menu-open");
                    const close = document.querySelector("#menu-close");

                    if (isOpening) {
                        ScrollSmoother.get().paused(true);
                        document.body.style.overflow = 'hidden';
                    }
                    else {
                        ScrollSmoother.get().paused(false);
                        document.body.style.overflow = '';
                    }

                    gsap.to(isOpening ? open : close, {
                        x: isOpening ? -5 : 5,
                        y: isOpening ? -10 : 10,
                        rotation: isOpening ? -5 : 5,
                        opacity: 0,
                        duration: .5,
                        delay: .5,
                        ease: "power2.out",
                    });

                    gsap.to(isOpening ? close : open, {
                        x: 0,
                        y: 0,
                        rotation: 0,
                        delay: .5,
                        opacity: 1,
                        duration: 0.5,
                        ease: "power2.out",
                    });
                }

                function openMenu() {
                    if (isAnimating || isOpen) return;
                    isAnimating = true;

                    gsap.to(container, {
                        x: 120,
                        y: 450,
                        scale: 1.5,
                        rotation: 10,
                        duration: .85,
                        delay: 0.1,
                        ease: "fastSlow",
                    });

                    animateMenuToggle(true);

                    gsap.to(menuContent, {
                        rotation: 0,
                        x: 0,
                        y: 0,
                        scale: 1,
                        opacity: 1,
                        duration: .85,
                        ease: "fastSlow",
                    });

                    gsap.to([".link a", ".social a"], {
                        y: "0%",
                        opacity: 1,
                        delay: 0.55,
                        duration: 1.2,
                        stagger: 0.1,
                        ease: "power3.out",
                    });

                    gsap.to(menuOverlay, {
                        clipPath: "polygon(0 0, 100% 0, 100% 175%, 0 100%)",
                        duration: .85,
                        ease: "fastSlow",
                        onComplete: () => {
                            isOpen = true;
                            isAnimating = false;
                        }
                    });

                }

                function closeMenu() {
                    if (isAnimating || !isOpen) return;
                    isAnimating = true;

                    gsap.to(container, {
                        x: 0,
                        y: 0,
                        scale: 1,
                        rotation: 0,
                        duration: .85,
                        ease: "power4.inOut",
                    });

                    animateMenuToggle(false);

                    gsap.to(menuContent, {
                        x: -100,
                        y: -100,
                        scale: 1.5,
                        rotation: -15,
                        opacity: 0.25,
                        duration: .85,
                        ease: "power4.inOut",
                    });

                    gsap.to(menuOverlay, {
                        clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)",
                        duration: .85,
                        ease: "power4.inOut",
                        onComplete: () => {
                            isOpen = false;
                            isAnimating = false;
                            gsap.set([".link a", ".social a"], {
                                y: "120%",
                            });
                            resetPreviewImage();
                        }
                    });


                }

                menuLinks.forEach((link) => {
                    // Event untuk hover gambar preview
                    link.addEventListener("mouseover", () => {
                        if (!isOpen || isAnimating) return;

                        const imgSrc = link.getAttribute("data-img");
                        if (!imgSrc) return;

                        const previewImages = menuPreviewImg.querySelectorAll("img");
                        const currentImage = previewImages[previewImages.length - 1];

                        // Check if current image is same as hovered one
                        if (currentImage && currentImage.src.includes(imgSrc)) {
                            return;
                        }

                        // Create new image and preload it
                        const newImage = new Image();
                        newImage.src = imgSrc;

                        newImage.onload = () => {
                            // Add new image to DOM
                            newImage.style.opacity = "0";
                            newImage.style.transform = "scale(1.1) rotate(2deg)";
                            newImage.style.position = "absolute";
                            newImage.style.top = "0";
                            newImage.style.left = "0";
                            newImage.style.width = "100%";
                            newImage.style.height = "100%";
                            menuPreviewImg.appendChild(newImage);

                            // Animate old images out
                            previewImages.forEach((img) => {
                                gsap.to(img, {
                                    opacity: 0,
                                    scale: 0.95,
                                    rotation: -2,
                                    duration: 0.6,
                                    ease: "power2.inOut",
                                    stagger: 0.1
                                });
                            });

                            // Animate new image in
                            gsap.fromTo(newImage,
                                {
                                    opacity: 0,
                                    scale: 1.1,
                                    rotation: 2
                                },
                                {
                                    opacity: 1,
                                    scale: 1,
                                    rotation: 0,
                                    duration: 0.8,
                                    ease: "power2.out",
                                    onComplete: () => {
                                        cleanupPreviewImage();
                                    }
                                }
                            );
                        };
                    });

                    link.addEventListener("click", (e) => {
                        if (!isOpen || isAnimating) return;

                        e.preventDefault(); // Prevent default for all links
                        const href = link.getAttribute("href");

                        // Close menu first
                        closeMenu();

                        if (href) {
                            if (href.startsWith("#")) {
                                // For internal hash links
                                setTimeout(() => {
                                    const targetElement = document.querySelector(href);
                                    if (targetElement) {
                                        targetElement.scrollIntoView({
                                            behavior: 'smooth'
                                        });
                                    }
                                }, 500);
                            } else {
                                // For external page navigation
                                window.scrollTo({
                                    top: 0,
                                    behavior: 'smooth'
                                });

                                setTimeout(() => {
                                    window.location.href = href;
                                }, 1200);
                            }
                        }
                    });
                });
                navLinks.forEach((link) => {
                    link.addEventListener("click", (e) => {
                        if (!isOpen || isAnimating) return;

                        e.preventDefault(); // Prevent default for all links
                        const href = link.getAttribute("href");

                        // Close menu first
                        closeMenu();

                        if (href) {
                            if (href.startsWith("#")) {
                                // For internal hash links
                                setTimeout(() => {
                                    const targetElement = document.querySelector(href);
                                    if (targetElement) {
                                        targetElement.scrollIntoView({
                                            behavior: 'smooth'
                                        });
                                    }
                                }, 500);
                            } else {
                                // For external page navigation
                                window.scrollTo({
                                    top: 0,
                                    behavior: 'smooth'
                                });

                                setTimeout(() => {
                                    window.location.href = href;
                                }, 1200);
                            }
                        }
                    });
                });
            }
        }

        class AdvancedVideoPlayer {
            constructor() {
                this.currentVideo = null;
                this.modal = document.getElementById('videoModal');
                this.container = document.getElementById('videoContainer');
                this.video = document.getElementById('mainVideo');
                this.playPauseBtn = document.getElementById('playPauseBtn');
                this.progressBar = document.getElementById('progressBar');
                this.progressFill = document.getElementById('progressFill');
                this.muteBtn = document.getElementById('muteBtn');
                this.volumeSlider = document.getElementById('volumeSlider');
                this.fullscreenBtn = document.getElementById('fullscreenBtn');
                this.closeBtn = document.getElementById('closeBtn');

                this.isOpen = false;
                this.scrollPosition = 0;

                this.init();
                this.createParticles();
            }

            init() {
                // Tambahkan event listener untuk semua tombol play
                document.querySelectorAll('.box_img').forEach(box => {
                    box.addEventListener('click', (e) => {
                        const videoSrc = box.closest('.box_tutor').dataset.video;
                        this.openVideo(videoSrc, box);
                    });
                });

                // Kontrol video
                this.playPauseBtn.addEventListener('click', () => this.togglePlayPause());
                this.muteBtn.addEventListener('click', () => this.toggleMute());
                this.volumeSlider.addEventListener('input', () => this.setVolume());
                this.fullscreenBtn.addEventListener('click', () => this.toggleFullscreen());
                this.closeBtn.addEventListener('click', () => this.closeVideo());

                // Progress bar
                this.progressBar.addEventListener('click', (e) => this.setProgress(e));
                this.video.addEventListener('timeupdate', () => this.updateProgress());
                this.video.addEventListener('loadedmetadata', () => this.updateProgress());

                // Klik overlay modal untuk menutup
                this.modal.addEventListener('click', (e) => {
                    if (e.target === this.modal) {
                        this.closeVideo();
                    }
                });

                // Kontrol keyboard
                document.addEventListener('keydown', (e) => {
                    if (this.modal.classList.contains('active')) {
                        switch (e.code) {
                            case 'Space':
                                e.preventDefault();
                                this.togglePlayPause();
                                break;
                            case 'Escape':
                                this.closeVideo();
                                break;
                            case 'KeyF':
                                this.toggleFullscreen();
                                break;
                            case 'KeyM':
                                this.toggleMute();
                                break;
                        }
                    }
                });

                // Event video
                this.video.addEventListener('ended', () => {
                    this.playPauseBtn.textContent = '▶';
                });

                this.video.addEventListener('play', () => {
                    this.playPauseBtn.textContent = '⏸';
                });

                this.video.addEventListener('pause', () => {
                    this.playPauseBtn.textContent = '▶';
                });
            }

            // Fungsi untuk menghitung lebar scrollbar
            getScrollbarWidth() {
                // Buat elemen div sementara untuk mengukur scrollbar
                const outer = document.createElement('div');
                outer.style.visibility = 'hidden';
                outer.style.overflow = 'scroll'; // Memaksa scrollbar muncul
                document.body.appendChild(outer);

                const inner = document.createElement('div');
                outer.appendChild(inner);

                const scrollbarWidth = outer.offsetWidth - inner.offsetWidth;
                outer.parentNode.removeChild(outer); // Hapus elemen sementara

                return scrollbarWidth;
            } async openVideo(videoSrc, thumbnailElement) {
                try {
                    if (this.isOpen) return;

                    // Store viewport position
                    const viewportY = window.scrollY;

                    // Get ScrollSmoother instance
                    const smoother = ScrollSmoother.get();
                    if (smoother) {
                        this.smoothProgress = smoother.scrollTrigger.progress;
                        this.scrollPosition = smoother.scrollTop();
                        smoother.paused(true);
                    }

                    // Lock scroll and add modal classes
                    document.documentElement.classList.add('modal-open');
                    document.body.classList.add('modal-open');                    // Show modal
                    this.modal.classList.add('active');

                    // Position modal container at viewport center
                    this.container.style.top = `${viewportY + (window.innerHeight / 2)}px`;

                    // Get spinner element
                    let spinner = thumbnailElement.querySelector('.loading-spinner');
                    if (!spinner) {
                        spinner = document.createElement('div');
                        spinner.className = 'loading-spinner';
                        thumbnailElement.appendChild(spinner);
                    }
                    spinner.style.display = 'block';

                    // Set up video sources
                    this.video.innerHTML = `
                        <source src="${videoSrc}" type="video/webm">
                        <source src="${videoSrc.replace('.webm', '.mp4')}" type="video/mp4">
                    `; this.video.load();

                    // Wait for video to be ready
                    await new Promise((resolve) => {
                        this.video.addEventListener('canplay', resolve, { once: true });
                    });

                    this.isOpen = true;

                    // Show and animate modal
                    this.modal.classList.add('active');
                    gsap.fromTo(this.container,
                        {
                            scale: 0.8,
                            opacity: 0
                        },
                        {
                            scale: 1,
                            opacity: 1,
                            y: 0,
                            duration: 0.4,
                            ease: "expo.out",
                            onComplete: () => {
                                // Hide loading spinner and play video
                                spinner.style.display = 'none';
                                this.video.play();
                            }
                        }
                    );

                } catch (error) {
                    console.error('Error loading video:', error);
                    spinner.style.display = 'none';
                    this.closeVideo();
                }
            } closeVideo() {
                if (!this.isOpen) return;
                this.isOpen = false;

                // Get ScrollSmoother instance
                const smoother = ScrollSmoother.get();

                // Stop video playback
                this.video.pause();

                // Animate modal out
                gsap.to(this.container, {
                    scale: 0.8,
                    opacity: 0,
                    y: 20,
                    duration: 0.3,
                    ease: "power2.in",
                    onComplete: () => {
                        // Clean up video and modal state
                        this.modal.classList.remove('active');
                        this.video.removeAttribute('src');
                        this.video.load();

                        // Remove scroll lock classes and padding
                        document.documentElement.classList.remove('modal-open');
                        document.body.classList.remove('modal-open');
                        document.body.style.paddingRight = '';
                        if (smoother) {
                            smoother.paused(false);
                            requestAnimationFrame(() => {
                                smoother.scrollTo(this.scrollPosition, {
                                    duration: 0,
                                    ease: "none"
                                });
                            });
                        }
                    }
                });
            }

            togglePlayPause() {
                if (this.video.paused) {
                    this.video.play();
                } else {
                    this.video.pause();
                }
            }

            toggleMute() {
                this.video.muted = !this.video.muted;
                this.muteBtn.textContent = this.video.muted ? '🔇' : '🔊';
                this.volumeSlider.value = this.video.muted ? 0 : this.video.volume;
            }

            setVolume() {
                this.video.volume = this.volumeSlider.value;
                this.video.muted = this.volumeSlider.value === '0';
                this.muteBtn.textContent = this.video.muted ? '🔇' : '🔊';
            }

            setProgress(e) {
                const rect = this.progressBar.getBoundingClientRect();
                const pos = (e.clientX - rect.left) / rect.width;
                this.video.currentTime = pos * this.video.duration;
            }

            updateProgress() {
                if (this.video.duration) {
                    const progress = (this.video.currentTime / this.video.duration) * 100;
                    this.progressFill.style.width = progress + '%';
                }
            }

            toggleFullscreen() {
                if (!document.fullscreenElement) {
                    this.modal.requestFullscreen();
                    this.fullscreenBtn.textContent = '⛉';
                } else {
                    document.exitFullscreen();
                    this.fullscreenBtn.textContent = '⛶';
                }
            }

            createParticles() {
                const particlesContainer = document.querySelector('.particles');
                const particleCount = 50;

                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.classList.add('particle');

                    // Posisi random
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.top = Math.random() * 100 + '%';

                    particlesContainer.appendChild(particle);

                    // Animasi partikel dengan GSAP
                    gsap.to(particle, {
                        y: -Math.random() * 500 - 100,
                        x: (Math.random() - 0.5) * 200,
                        opacity: 0,
                        duration: Math.random() * 3 + 2,
                        ease: "power1.out",
                        repeat: -1,
                        delay: Math.random() * 2
                    });
                }
            }
        }

        // Sistem animasi scroll modern dengan timeline berurutan
        class ScrollAnimationManager {
            constructor() {
                this.initScrollAnimations();
                this.initFooterAnimations();
                this.initHeaderScrollAnimations();
            }

            initScrollAnimations() {
                document.querySelectorAll('.box_tutor').forEach((tutorBox, index) => {
                    const mainTimeline = gsap.timeline({ paused: true });

                    mainTimeline.fromTo(tutorBox, {
                        opacity: 0,
                        y: 100
                    }, {
                        opacity: 1,
                        y: 0,
                        duration: 0.7,
                        ease: "power2.out"
                    });

                    const textTimeline = gsap.timeline({ paused: true, });

                    const charImg = tutorBox.querySelector('.char_img img');
                    if (charImg) {
                        textTimeline.fromTo(charImg,
                            {
                                x: -100,
                                opacity: 0,
                                rotation: -10
                            },
                            {
                                x: 0,
                                opacity: 1,
                                rotation: 0,
                                duration: 1,
                                ease: "elastic.out(1, 0.5)",
                            }
                        );
                    }

                    const title = tutorBox.querySelector('.box_text .box_title .title');
                    if (title) {
                        textTimeline.fromTo(title, {
                            y: '100%',
                            opacity: 0
                        }, {
                            y: '0%',
                            opacity: 1,
                            duration: 0.6,
                            ease: "power2.out"
                        }, 0.2);
                    }

                    const description = tutorBox.querySelector('.box_text .box_description .description');
                    if (description) {
                        textTimeline.fromTo(description, {
                            y: '100%',
                            opacity: 0
                        }, {
                            y: '0%',
                            opacity: 1,
                            duration: 0.6,
                            ease: "power2.out"
                        }, 0.4);
                    }

                    const jpnText = tutorBox.querySelector('.box_text .box_jpn .jpn');
                    if (jpnText) {
                        textTimeline.fromTo(jpnText, {
                            y: '100%',
                            opacity: 0
                        }, {
                            y: '0%',
                            opacity: 1,
                            duration: 0.6,
                            ease: "power2.out"
                        }, 0.6);
                    }


                    ScrollTrigger.create({
                        trigger: tutorBox,
                        start: "top 99%",
                        // markers: true,
                        onEnter: () => {
                            mainTimeline.play();
                            textTimeline.play();
                        }
                    });
                });
            }

            initHeaderScrollAnimations() {
                const studyTm = gsap.timeline({ paused: true });
                const galleryTm = gsap.timeline({ paused: true });

                studyTm.fromTo(['.study-title .mask-text h2', '.study-title .mask-text p'], {
                    y: '100%',
                    opacity: 0
                }, {
                    y: '0%',
                    opacity: 1,
                    duration: .6,
                    ease: "power2.out"
                }, 0.2);

                galleryTm.fromTo(['.gallery-title .mask-text h2', '.gallery-title .mask-text p'], {
                    y: '100%',
                    opacity: 0
                }, {
                    y: '0%',
                    opacity: 1,
                    duration: .6,
                    ease: "power2.out"
                }, 0.2);

                ScrollTrigger.create({
                    trigger: '.study-title',
                    // markers: true,
                    start: "top 80%",
                    onEnter: () => {
                        studyTm.play();
                    }
                });

                ScrollTrigger.create({
                    trigger: '.gallery-title',
                    // markers: true,
                    start: "top 80%",
                    onEnter: () => {
                        galleryTm.play();
                    }
                });

            }


            initFooterAnimations() {
                const footerTimeline = gsap.timeline({ paused: true });

                footerTimeline.to('.footer-section', {
                    opacity: 1,
                    y: 0,
                    duration: 0.7,
                    stagger: 0.1,
                    ease: "power2.out"
                });

                footerTimeline.to('.mask-text', {
                    y: 0,
                    duration: 0.7,
                    stagger: 0.1,
                    ease: "power3.out"
                }, 0.3);

                footerTimeline.to('.link-text', {
                    y: 0,
                    duration: 0.7,
                    stagger: 0.08,
                    ease: "power3.out"
                }, 0.6);

                footerTimeline.to('.footer-section ul li', {
                    opacity: 1,
                    duration: 0.4,
                    stagger: 0.08,
                    ease: "power2.out"
                }, 0.6);

                footerTimeline.to('.nakoclass-section', {
                    opacity: 1,
                    y: 0,
                    duration: 0.8,
                    ease: "power2.out"
                }, 0.4);

                footerTimeline.to('.bottom-text', {
                    y: 0,
                    duration: 0.4,
                    ease: "power3.out"
                }, 1);

                footerTimeline.to('.footer-bottom', {
                    opacity: 1,
                    y: 0,
                    duration: 0.5,
                    ease: "power2.out"
                }, 1);

                ScrollTrigger.create({
                    trigger: '.footer',
                    start: "top 80%",
                    onEnter: () => {
                        footerTimeline.play();
                    }
                });

                document.querySelectorAll('.footer-section ul li a').forEach(link => {
                    link.addEventListener('mouseenter', () => {
                        gsap.to(link, {
                            x: 3,
                            duration: 0.05,
                            ease: "power1.out"
                        });
                    });

                    link.addEventListener('mouseleave', () => {
                        gsap.to(link, {
                            x: 0,
                            duration: 0.05,
                            ease: "power2.out"
                        });
                    });
                });
            }

        }

        // Horizontal Scroll Slider
        class HorizontalScrollSlider {
            constructor() {
                this.section = document.querySelector('.horizontal-scroll-section');
                this.cardsContainer = document.querySelector('.cards-container');
                this.cards = document.querySelectorAll('.tutorial-card');
                this.progressDots = document.querySelectorAll('.progress-dot');
                this.currentIndex = 0;

                this.init();
            }

            init() {
                this.setupHorizontalScroll();
                this.setupCardAnimations();
                this.setupProgressIndicator();
                this.setupDrawingEffect();
            }

            setupHorizontalScroll() {
                if (this.cardsContainer && this.cards.length > 0) {
                    const totalWidth = this.cardsContainer.scrollWidth;
                    const viewportWidth = window.innerWidth;
                    const scrollDistance = totalWidth - viewportWidth;

                    gsap.to(this.cardsContainer, {
                        x: -scrollDistance,
                        ease: "none",
                        scrollTrigger: {
                            trigger: this.section,
                            start: "top top",
                            end: () => `+=${scrollDistance}`,
                            scrub: 1,
                            pin: true,
                            anticipatePin: 1,
                            onUpdate: (self) => {
                                this.updateProgressIndicator(self.progress);
                            }
                        }
                    });
                }
            }

            setupCardAnimations() {
                this.cards.forEach((card, index) => {
                    gsap.set(card, {
                        opacity: 0,
                        x: 100,
                        y: 50,
                        filter: "blur(10px)",
                        scale: 0.9
                    });

                    gsap.to(card, {
                        opacity: 1,
                        x: 0,
                        y: 0,
                        filter: "blur(0px)",
                        scale: 1,
                        duration: 1.2,
                        delay: index * 0.15,
                        ease: "power3.out",
                        scrollTrigger: {
                            trigger: this.section,
                            start: "top 80%",
                            toggleActions: "play none none"
                        }
                    });

                    const cardContent = card.querySelector('.card-content');
                    const cardImg = card.querySelector('.card-img img');

                    const heightCardContent = cardContent.scrollHeight;

                    card.addEventListener('mouseenter', () => {
                        gsap.to(cardContent, {
                            height: (heightCardContent + 50) + 'px',
                            duration: 0.1,
                            ease: "bounce.in"
                        });

                        gsap.to(cardImg, {
                            scale: 1.2,
                            duration: 0.3,
                            ease: "power2.out"
                        });
                    });

                    card.addEventListener('mouseleave', () => {
                        gsap.to(cardContent, {
                            height: heightCardContent,
                            duration: 0.2,
                            ease: "bounce.out"
                        });

                        gsap.to(cardImg, {
                            scale: 1,
                            duration: 0.3,
                            ease: "power2.out"
                        });
                    });
                });
            }

            setupDrawingEffect() {
                this.cards.forEach((card, index) => {
                    const drawingElement = card.querySelector('.drawing-effect');

                    ScrollTrigger.create({
                        trigger: card,
                        start: "left 80%",
                        onEnter: () => {
                            setTimeout(() => {
                                drawingElement?.classList.add('animate');
                            }, index * 200);
                        }
                    });
                });
            }

            setupProgressIndicator() {
                this.progressDots.forEach((dot, index) => {
                    dot.addEventListener('click', () => {
                        this.goToCard(index);
                    });
                });
            }

            updateProgressIndicator(progress) {
                const totalCards = this.cards.length;
                const currentCardIndex = Math.floor(progress * totalCards);

                this.progressDots.forEach((dot, index) => {
                    dot.classList.toggle('active', index === currentCardIndex);
                });
            }

            goToCard(index) {
                if (index >= 0 && index < this.cards.length) {
                    const cardWidth = this.cards[0].offsetWidth + 60;
                    const targetX = -cardWidth * index;

                    gsap.to(this.cardsContainer, {
                        x: targetX,
                        duration: 1,
                        ease: "power2.inOut"
                    });

                    this.currentIndex = index;
                    this.updateProgressIndicator(index / (this.cards.length - 1));
                }
            }
        }

        class GalleryImage {
            constructor() {
                this.grid = document.getElementById('gallery-grid-container');
                this.modalOverlay = document.getElementById('gallery-modal-overlay');
                this.modalContent = document.getElementById('gallery-modal-content');
                this.modalImage = document.getElementById('gallery-modal-image');
                this.gallerySection = document.getElementById('gallery-section');
                this.dragProxy = document.querySelector('.gallery-grid-padding');
                // this.cursor = document.getElementById('gallery-cursor');
                // this.arrow1 = document.getElementById('gallery-arrow1');
                // this.arrow2 = document.getElementById('gallery-arrow2');
                this.navHint = document.getElementById('navHint');

                // Gallery configuration
                this.CARD_WIDTH_VW = 20;
                this.CARD_HEIGHT_VH = 47;
                this.RENDER_RADIUS = 2000;
                this.CULL_RADIUS = 2400;
                this.GAP = 80;
                this.STAGGER_OFFSET = 0.4;

                this.imageList = [
                    'images/anime_1.webp',
                    'images/anime_2.png',
                    'images/anime_3.jpg',
                    'images/anime_4.jpg',
                    'images/anime_5.jpg',
                ];

                this.occupied = new Map();
                this.recyclePool = [];
                this.cardWidthPx = window.innerWidth * (this.CARD_WIDTH_VW / 100);
                this.cardHeightPx = window.innerHeight * (this.CARD_HEIGHT_VH / 100);
                this.draggableInstance = null;

                // Position tracking
                this.currentGridX = 0;
                this.currentGridY = 0;
                this.targetGridX = 0;
                this.targetGridY = 0;
                this.isDragging = false;
                this.isInertiaActive = false;
                this.smoothFactor = 0.15;
                this.isGalleryActive = false;
                this.animationFrameId = null;

                // Auto-scroll properties
                this.isAutoScrolling = false;
                this.autoScrollSpeed = .8;
                this.scrollDirection = {
                    x: (Math.random() - 0.5) * 2,
                    y: (Math.random() - 0.5) * 2
                };
                this.autoScrollFrameId = null;
                this.directionChangeTimer = 0;
                this.directionChangeInterval = 300; // frames between direction changes

                // Cursor state
                this.mouseX = 0;
                this.mouseY = 0;
                this.prevMouseX = 0;
                this.prevMouseY = 0;
                this.currentAngle = 0;
                this.targetAngle = 0;

                console.log("GalleryImage class instantiated.");
                this.init();
            }

            init() {
                this.setupScrollTrigger();
                this.setupDraggable();
                this.setupModal();
                this.setupResize();
            }

            setupScrollTrigger() {
                const baseWidth = 900; // lebar awal dalam px
                const maxWidth = 1400;

                gsap.set(this.dragProxy, {
                    y: 200,
                    rotation: 5,
                    transformOrigin: 'center center',
                });

                ScrollTrigger.create({
                    trigger: this.gallerySection,
                    start: "start 70%",
                    end: "bottom center",
                    // markers: true,
                    onEnter: () => {
                        this.activateGallery();
                        this.dragProxy.classList.add('active');
                        this.hideHintAfterDelay();
                    },
                    onLeave: () => {
                        this.deactivateGallery();
                    },
                    onEnterBack: () => {
                        this.activateGallery();
                        this.dragProxy.classList.add('active');
                    },
                    onLeaveBack: () => {
                        this.deactivateGallery();
                    },
                    onUpdate: (self) => {
                        gsap.to(this.dragProxy, {
                            y: 0,
                            rotation: 0,
                            duration: .1,
                            ease: "power2.out"
                        });
                    },
                });
            }

            activateGallery() {
                if (this.isGalleryActive) return;
                console.log("Activating gallery");
                this.isGalleryActive = true;
                this.gallerySection.classList.add('gallery-active');
                if (this.draggableInstance) this.draggableInstance[0].enable();
                this.updateGrid();
                this.startSmoothUpdate();
                this.startAutoScroll(); // Start auto-scroll when gallery is active
            }

            deactivateGallery() {
                if (!this.isGalleryActive) return;
                console.log("Deactivating gallery");
                this.isGalleryActive = false;
                this.gallerySection.classList.remove('gallery-active');
                if (this.draggableInstance) this.draggableInstance[0].disable();
                this.stopSmoothUpdate();
                this.stopAutoScroll(); // Stop auto-scroll when gallery is inactive
            }

            startAutoScroll() {
                if (this.autoScrollFrameId) return;
                console.log("Starting auto-scroll");

                const autoScroll = () => {
                    if (this.isGalleryActive && this.isAutoScrolling && !this.isDragging && !this.isInertiaActive) {
                        // Update position based on scroll direction and speed
                        this.targetGridX += this.scrollDirection.x * this.autoScrollSpeed;
                        this.targetGridY += this.scrollDirection.y * this.autoScrollSpeed;

                        // Smoothly interpolate to target position
                        this.currentGridX += (this.targetGridX - this.currentGridX) * this.smoothFactor;
                        this.currentGridY += (this.targetGridY - this.currentGridY) * this.smoothFactor;

                        // Apply position to grid
                        gsap.set(this.grid, {
                            x: this.currentGridX,
                            y: this.currentGridY
                        });

                        // Update draggable position to match
                        if (this.draggableInstance) {
                            this.draggableInstance[0].x = this.currentGridX;
                            this.draggableInstance[0].y = this.currentGridY;
                        }

                        // Update grid cards
                        this.updateGrid();

                        // Change direction occasionally
                        this.directionChangeTimer++;
                        if (this.directionChangeTimer >= this.directionChangeInterval) {
                            if (Math.random() < 0.3) { // 30% chance to change direction
                                this.scrollDirection.x = (Math.random() - 0.5) * 2;
                                this.scrollDirection.y = (Math.random() - 0.5) * 2;
                                console.log("Changed auto-scroll direction:", this.scrollDirection);
                            }
                            this.directionChangeTimer = 0;
                        }
                    }

                    if (this.isGalleryActive) {
                        this.autoScrollFrameId = requestAnimationFrame(autoScroll);
                    }
                };

                // Start auto-scroll after initial delay
                setTimeout(() => {
                    this.isAutoScrolling = true;
                    console.log("Auto-scroll activated");
                    this.autoScrollFrameId = requestAnimationFrame(autoScroll);
                }, 1000);
            }

            stopAutoScroll() {
                console.log("Stopping auto-scroll");
                this.isAutoScrolling = false;
                if (this.autoScrollFrameId) {
                    cancelAnimationFrame(this.autoScrollFrameId);
                    this.autoScrollFrameId = null;
                }
            }

            hideHint() {
                this.navHint.classList.add('hidden');
            }

            hideHintAfterDelay() {
                setTimeout(() => {
                    this.hideHint();
                }, 15000);
            }

            generateCard(x, y) {
                const key = `${x}:${y}`;
                let cardEl;

                if (this.recyclePool.length > 0) {
                    cardEl = this.recyclePool.pop();
                } else {
                    cardEl = document.createElement('div');
                    cardEl.className = 'card-gallery';
                    const imgEl = document.createElement('img');
                    // const coordsEl = document.createElement('div');
                    // coordsEl.className = 'card-coords';
                    cardEl.appendChild(imgEl);
                    // cardEl.appendChild(coordsEl);
                }

                const imgIndex = Math.abs(x * 13 + y * 31) % this.imageList.length;
                cardEl.querySelector('img').src = this.imageList[imgIndex];
                // cardEl.querySelector('.card-coords').textContent = `(${x}, ${y})`;

                const yOffset = (Math.abs(x) % 2 === 1) ? this.cardHeightPx * this.STAGGER_OFFSET : 0;
                this.grid.appendChild(cardEl);

                gsap.fromTo(cardEl, {
                    opacity: 0,
                    scale: 0.95,
                    x: x * (this.cardWidthPx + this.GAP),
                    y: y * (this.cardHeightPx + this.GAP) + yOffset,
                    width: this.cardWidthPx,
                    height: this.cardHeightPx
                }, {
                    opacity: 1,
                    scale: 1,
                    duration: 0.4,
                    ease: 'power2.out',
                    delay: Math.random() * 0.2
                });

                const cardData = { element: cardEl, x, y, yOffset };
                this.occupied.set(key, cardData);
                return cardData;
            }

            updateGrid() {
                if (!this.isGalleryActive) return;

                const gridBounds = this.grid.getBoundingClientRect();
                const viewportCenterX = -gridBounds.x + window.innerWidth / 2;
                const viewportCenterY = -gridBounds.y + window.innerHeight / 2;

                const startX = Math.floor((viewportCenterX - this.RENDER_RADIUS) / (this.cardWidthPx + this.GAP));
                const endX = Math.ceil((viewportCenterX + this.RENDER_RADIUS) / (this.cardWidthPx + this.GAP));
                const startY = Math.floor((viewportCenterY - this.RENDER_RADIUS) / (this.cardHeightPx + this.GAP));
                const endY = Math.ceil((viewportCenterY + this.RENDER_RADIUS) / (this.cardHeightPx + this.GAP));

                this.occupied.forEach((cardData, key) => {
                    const cardCenterX = cardData.x * (this.cardWidthPx + this.GAP) + this.cardWidthPx / 2;
                    const cardCenterY = cardData.y * (this.cardHeightPx + this.GAP) + cardData.yOffset + this.cardHeightPx / 2;
                    const distance = Math.hypot(cardCenterX - viewportCenterX, cardCenterY - viewportCenterY);

                    if (distance > this.CULL_RADIUS) {
                        const el = cardData.element;
                        this.occupied.delete(key);
                        gsap.to(el, {
                            opacity: 0,
                            scale: 0.95,
                            duration: 0.4,
                            ease: 'power2.in',
                            onComplete: () => {
                                if (this.grid.contains(el)) {
                                    this.grid.removeChild(el);
                                    this.recyclePool.push(el);
                                }
                            }
                        });
                    }
                });

                for (let x = startX; x <= endX; x++) {
                    for (let y = startY; y <= endY; y++) {
                        const key = `${x}:${y}`;
                        if (this.occupied.has(key)) continue;

                        const yOffset = (Math.abs(x) % 2 === 1) ? this.cardHeightPx * this.STAGGER_OFFSET : 0;
                        const cardCenterX = x * (this.cardWidthPx + this.GAP) + this.cardWidthPx / 2;
                        const cardCenterY = y * (this.cardHeightPx + this.GAP) + yOffset + this.cardHeightPx / 2;
                        const distance = Math.hypot(cardCenterX - viewportCenterX, cardCenterY - viewportCenterY);

                        if (distance < this.RENDER_RADIUS) {
                            this.generateCard(x, y);
                        }
                    }
                }
            }

            setupDraggable() {
                console.log("Setting up Draggable");
                this.draggableInstance = Draggable.create(this.grid, {
                    type: "x,y",
                    trigger: this.dragProxy,
                    edgeResistance: 0.05,
                    inertia: true,
                    onPress: () => {
                        console.log("Draggable: onPress");
                        const smoother = ScrollSmoother.get();
                        if (smoother) smoother.paused(true);
                        this.isDragging = true;
                        this.isInertiaActive = false;
                        this.isAutoScrolling = false; // Stop auto-scroll when dragging
                        this.targetGridX = this.draggableInstance[0].x;
                        this.targetGridY = this.draggableInstance[0].y;
                    },
                    onDrag: () => {
                        this.targetGridX = this.draggableInstance[0].x;
                        this.targetGridY = this.draggableInstance[0].y;
                        this.hideHint();
                    },
                    onDragEnd: () => {
                        console.log("Draggable: onDragEnd");
                        this.isDragging = false;
                        if (!this.draggableInstance[0].isThrowing) {
                            const smoother = ScrollSmoother.get();
                            if (smoother) smoother.paused(false);
                            // Resume auto-scroll after a delay when not throwing
                            setTimeout(() => {
                                if (!this.isDragging && !this.isInertiaActive) {
                                    this.isAutoScrolling = true;
                                }
                            }, 3000);
                        } else {
                            this.isInertiaActive = true;
                        }
                    },
                    onThrowUpdate: () => {
                        this.targetGridX = this.draggableInstance[0].x;
                        this.targetGridY = this.draggableInstance[0].y;
                        this.updateGrid();
                    },
                    onThrowComplete: () => {
                        console.log("Draggable: onThrowComplete");
                        this.isInertiaActive = false;
                        const smoother = ScrollSmoother.get();
                        if (smoother) smoother.paused(false);
                        // Resume auto-scroll after throw is complete
                        setTimeout(() => {
                            if (!this.isDragging && !this.isInertiaActive) {
                                this.isAutoScrolling = true;
                            }
                        }, 3000);
                    },
                    onClick: (e) => {
                        console.log("Draggable: onClick");
                        if (!this.draggableInstance[0].isDragging) {
                            const card = e.target.closest('.card-gallery');
                            if (card) {
                                const imgSrc = card.querySelector('img').src;
                                this.showModal(imgSrc);
                            }
                        }
                    }
                });
                this.draggableInstance[0].disable();
            }

            startSmoothUpdate() {
                if (this.animationFrameId) return;
                console.log("Starting smooth update loop");
                const update = () => {
                    if (this.isDragging) {
                        this.currentGridX += (this.targetGridX - this.currentGridX) * this.smoothFactor;
                        this.currentGridY += (this.targetGridY - this.currentGridY) * this.smoothFactor;
                        gsap.set(this.grid, { x: this.currentGridX, y: this.currentGridY });
                        this.draggableInstance[0].x = this.currentGridX;
                        this.draggableInstance[0].y = this.currentGridY;
                    } else if (this.isInertiaActive) {
                        this.currentGridX = this.draggableInstance[0].x;
                        this.currentGridY = this.draggableInstance[0].y;
                    }

                    // Only update grid if not auto-scrolling (to prevent conflicts)
                    if (!this.isAutoScrolling) {
                        this.updateGrid();
                    }

                    if (this.isGalleryActive) {
                        this.animationFrameId = requestAnimationFrame(update);
                    }
                };
                this.animationFrameId = requestAnimationFrame(update);
            }

            stopSmoothUpdate() {
                console.log("Stopping smooth update loop");
                if (this.animationFrameId) {
                    cancelAnimationFrame(this.animationFrameId);
                    this.animationFrameId = null;
                }
            }

            setupModal() {
                this.modalOverlay.addEventListener('click', (e) => {
                    if (e.target === this.modalOverlay) {
                        this.hideModal();
                    }
                });
            }

            showModal(imageUrl) {
                console.log("Showing modal");
                if (this.draggableInstance) this.draggableInstance[0].disable();
                this.isAutoScrolling = false; // Stop auto-scroll when modal is open

                const smoother = ScrollSmoother.get();
                if (smoother) smoother.paused(true);

                this.modalImage.src = imageUrl;
                document.body.classList.add('modal-open');
                this.modalOverlay.classList.add('active');

                const viewportY = smoother ? smoother.scrollTop() : window.scrollY;
                gsap.set(this.modalContent, { y: viewportY + (window.innerHeight / 2) });
                gsap.fromTo(this.modalContent,
                    { scale: 0.8, opacity: 0 },
                    { scale: 1, opacity: 1, duration: 0.4, ease: "expo.out" }
                );
            }

            hideModal() {
                console.log("Hiding modal");
                gsap.to(this.modalContent, {
                    scale: 0.8,
                    opacity: 0,
                    duration: 0.3,
                    ease: "power2.in",
                    onComplete: () => {
                        document.body.classList.remove('modal-open');
                        this.modalOverlay.classList.remove('active');
                        if (this.isGalleryActive && this.draggableInstance) {
                            this.draggableInstance[0].enable();
                        }
                        const smoother = ScrollSmoother.get();
                        if (smoother) smoother.paused(false);

                        // Resume auto-scroll after modal is closed
                        setTimeout(() => {
                            if (this.isGalleryActive && !this.isDragging && !this.isInertiaActive) {
                                this.isAutoScrolling = true;
                            }
                        }, 1000);
                    }
                });
            }

            setupResize() {
                window.addEventListener('resize', () => {
                    this.cardWidthPx = window.innerWidth * (this.CARD_WIDTH_VW / 100);
                    this.cardHeightPx = window.innerHeight * (this.CARD_HEIGHT_VH / 100);

                    this.occupied.forEach(cardData => {
                        const yOffset = (Math.abs(cardData.x) % 2 === 1) ? this.cardHeightPx * this.STAGGER_OFFSET : 0;
                        cardData.yOffset = yOffset;
                        gsap.set(cardData.element, {
                            x: cardData.x * (this.cardWidthPx + this.GAP),
                            y: cardData.y * (this.cardHeightPx + this.GAP) + yOffset,
                            width: this.cardWidthPx,
                            height: this.cardHeightPx
                        });
                    });

                    this.updateGrid();
                });
            }
        }
    </script>
</body>

</html>