<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="background_custom">
        <div class="svg_body_bg">
            <div class="circle_lg">
                <svg width="533" height="533" viewBox="0 0 533 533" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g filter="url(#filter0_f_44_1569)">
                        <circle cx="266.5" cy="266.5" r="204.75" fill="#FEE193" fill-opacity="0.6" />
                    </g>
                    <defs>
                        <filter id="filter0_f_44_1569" x="0.780003" y="0.780003" width="531.44" height="531.44"
                            filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                            <feFlood flood-opacity="0" result="BackgroundImageFix" />
                            <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape" />
                            <feGaussianBlur stdDeviation="30.485" result="effect1_foregroundBlur_44_1569" />
                        </filter>
                    </defs>
                </svg>
            </div>

            <div class="circle_sm">
                <svg width="305" height="296" viewBox="0 0 305 296" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g filter="url(#filter0_f_44_1570)">
                        <ellipse cx="152.5" cy="148" rx="99.9" ry="94.8" fill="#B8E0D8" fill-opacity="0.6" />
                    </g>
                    <defs>
                        <filter id="filter0_f_44_1570" x="0.339607" y="0.939949" width="304.32" height="294.12"
                            filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                            <feFlood flood-opacity="0" result="BackgroundImageFix" />
                            <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape" />
                            <feGaussianBlur stdDeviation="26.13" result="effect1_foregroundBlur_44_1570" />
                        </filter>
                    </defs>
                </svg>
            </div>
        </div>
    </div>

    <nav>
        <div class="logo">
            <a href="#">NakoClass</a>
        </div>
        <div class="nav-links">
            <ul>
                <li><a href="home.html">Home</a></li>
                <li><a href="navbar_gsap_update.html">Cara Menggambar</a></li>
                <li><a href="referensi.html">Referensi</a></li>
                <li><a href="toko.html">Toko</a></li>
            </ul>
        </div>
        <div class="menu-toggle">
            <p id="menu-open">Menu</p>
            <p id="menu-close">Close</p>
        </div>
    </nav>

    <div class="menu-overlay">
        <div class="menu-content">
            <div class="menu-items">
                <div class="col-lg">
                    <div class="menu-preview-img">
                        <img src="4.png" alt="">
                    </div>
                </div>
                <div class="col-sm">
                    <div class="menu-links">
                        <div class="link">
                            <a href="home.html" data-img="1.jpg">Home</a>
                        </div>
                        <div class="link">
                            <a href="navbar_gsap_update.html" data-img="wp5.jpg">Cara Menggambar</a>
                        </div>
                        <div class="link">
                            <a href="referensi.html" data-img="wp6.jpg">Referensi</a>
                        </div>
                        <div class="link">
                            <a href="toko.html" data-img="3.jpg">Toko</a>
                        </div>
                    </div>
                    <div class="menu-socials">
                        <div class="social">
                            <a href="#">Instagram</a>
                        </div>
                        <div class="social">
                            <a href="#">WhatsApp</a>
                        </div>
                        <div class="social">
                            <a href="#">LinkedIn</a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div class="menu-footer">
                <div class="col-lg">
                    <a href="#">Testing</a>
                </div>
                <div class="col-sm">
                    <a href="#">Origin</a>
                    <a href="#">Join Signal</a>
                </div>
            </div> -->
        </div>
    </div>

    <!-- Splashscreen -->
    <!-- <div class="splash_screen">
        <div class="splash-content">
            <span>N</span>
            <span>A</span>
            <span>K</span>
            <span>O</span>
            <span>C</span>
            <span>L</span>
            <span>A</span>
            <span>S</span>
            <span>S</span>
        </div>
        <svg class="splash-svg" viewBox="0 0 1440 420" preserveAspectRatio="none" width="1440" height="420">
            <path id="curve" d="M0,0 Q820,820 1440,0 L1440,-280 L0,-280 Z" fill="#000" />
        </svg>
    </div> -->

    <!-- Main Contant -->
    <div id="smooth-wrapper" class="container">
        <div id="smooth-content">
            <section id="home" class="hero">
                <!-- <div class="hero-img">
                    <img src="https://a.storyblok.com/f/133769/1920x2716/5c24d6b467/exo-ape-hero-1.jpg/m/2400x3395/filters:quality(90)"
                        alt="">
                </div> -->
                <div class="box-title">
                    <h1>Master the art of drawing <br> Manga step by step</h1>
                    <span>マンガの描き方を基本から上達まで学ぼう</span>
                </div>
            </section>
            <section id="core" class="body-content">
                <h1>Core</h1>
            </section>
            <section id="contact" class="body-content">
                <h1>Contact</h1>
            </section>
            <section id="about" class="body-content">
                <h1>About</h1>
            </section>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/CustomEase.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollSmoother.min.js"
        integrity="sha512-t4hwZimhnCKT3YLAsEcAcRDkngVFfCcUIfNLIjklrIZAZKD+GfQMP7HbRcsVHxNS48WRBSywNU1uSM2zzLQt1Q=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>

        gsap.registerPlugin(CustomEase, ScrollSmoother, ScrollTrigger);
        CustomEase.create("fastSlow", "M0,0 C0.83,0 0.17,1 1,1");

        document.addEventListener("DOMContentLoaded", () => {
            // Smooth Scrolling
            ScrollSmoother.create({
                wrapper: "#smooth-wrapper",
                content: "#smooth-content",
                smooth: 2.2,
                effects: true,
                smoothTouch: 0.1,
                normalizeScroll: true,
                ignoreMobileResize: true,
            });

            // Splashscreen Animation
            // window.addEventListener('load', () => {
            //     window.scrollTo({
            //         top: 0,
            //         behavior: 'smooth'
            //     });

            //     const splashScreen = document.querySelector('.splash_screen');
            //     const containers = document.querySelectorAll('.container');
            //     const textSpans = document.querySelectorAll('.splash-content span');

            //     document.body.style.overflowY = 'hidden';
            //     document.documentElement.style.overflowY = 'hidden';

            //     document.body.style.overflowX = 'hidden';
            //     document.documentElement.style.overflowX = 'hidden';

            //     // Create timeline for synchronized animation
            //     let tl = gsap.timeline();

            //     tl.to(textSpans, {
            //         y: "0%",
            //         opacity: 1,
            //         delay: 0.4,
            //         duration: .7,
            //         stagger: 0.1,
            //         ease: "power3.out",
            //     }).to(splashScreen, {
            //         duration: .7,
            //         y: '-100%',
            //         position: 'relative',
            //         opacity: 1,
            //         // delay: 1.0,
            //         ease: 'power2.inOut',
            //         stagger: 0,
            //         onComplete: () => {
            //             splashScreen.style.display = 'none';
            //             document.body.style.overflowY = 'auto';
            //             document.documentElement.style.overflowY = 'auto';

            //             document.body.style.overflowX = 'hidden';
            //             document.documentElement.style.overflowX = 'hidden';

            //             // Reset container positions
            //             containers.forEach(container => {
            //                 container.style.transform = 'none';
            //             });
            //         }
            //     }).to("#curve", {
            //         duration: .6,
            //         ease: "power4.inOut",
            //         attr: {
            //             d: "M0,0 Q820,0 1440,0 L1440,-280 L0,-280 Z"
            //         }
            //     }, "-=.5");
            // });

            // Background Animation
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const movementRadius = 120;

            function randomInRange(min, max) {
                return Math.random() * (max - min) + min;
            }

            function animateCircleRandom(selector, baseScale = 1, delay = 0) {
                function move() {
                    const x = randomInRange(-movementRadius, movementRadius);
                    const y = randomInRange(-movementRadius, movementRadius);
                    const scale = randomInRange(baseScale * 0.8, baseScale * 1.2);

                    gsap.to(selector, {
                        duration: 1.5,
                        x,
                        y,
                        scale,
                        ease: "sine.inOut",
                        onComplete: move,
                        delay
                    });
                }
                move();
            }

            // Large circle random movement and scale
            animateCircleRandom(".circle_lg", 0.5);

            // Small circle random movement and scale
            animateCircleRandom(".circle_sm", 1.0, 0.2); //

            // 
            // Navigation Bar Animation
            ScrollTrigger.create({
                trigger: "body",
                start: "top -100px",
                end: "bottom bottom",
                onEnter: () => {
                    // NavLinks hilang 
                    gsap.to(".nav-links", {
                        clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)",
                        duration: 0.5,
                        ease: "power2.in",
                        onComplete: () => {
                            gsap.set(".nav-links", { display: "none" });
                        }
                    });

                    // MenuToggle 
                    gsap.set(".menu-toggle", {
                        display: "block",
                        delay: 0.5,
                        clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)"
                    });
                    gsap.to(".menu-toggle", {
                        clipPath: "polygon(0 0, 100% 0, 100% 100%, 0 100%)",
                        opacity: 1,
                        duration: 0.6,
                        ease: "power3.out",
                        delay: 0.8
                    });
                },
                onLeaveBack: () => {
                    // MenuToggle hilang
                    gsap.to(".menu-toggle", {
                        clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)",
                        opacity: 0,
                        duration: 0.5,
                        ease: "power2.in",
                        onComplete: () => {
                            gsap.set(".menu-toggle", { display: "none" });
                        }
                    });

                    // NavLinks muncul kembali dengan clip-path
                    gsap.set(".nav-links", {
                        display: "block",
                        delay: 0.5,
                        clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)"
                    });
                    gsap.to(".nav-links", {
                        clipPath: "polygon(0 0, 100% 0, 100% 100%, 0 100%)",
                        duration: 0.6,
                        ease: "power3.out",
                        delay: 0.8
                    });
                }
            });

            // Navigation Menu
            const container = document.querySelector(".container");
            const menuToggle = document.querySelector(".menu-toggle");
            const menuOverlay = document.querySelector(".menu-overlay");
            const menuContent = document.querySelector(".menu-content");
            const menuPreviewImg = document.querySelector(".menu-preview-img");
            const menuLinks = document.querySelectorAll(".link a");
            const navLinks = document.querySelectorAll(".nav-links a");

            let isOpen = false;
            let isAnimating = false;

            menuToggle.addEventListener("click", () => {
                if (!isOpen) openMenu();
                else closeMenu();
            });

            function cleanupPreviewImage() {
                const previewImages = menuPreviewImg.querySelectorAll("img");
                if (previewImages.length > 3) {
                    for (let i = 0; i < previewImages.length - 3; i++) {
                        menuPreviewImg.removeChild(previewImages[i]);
                    }
                }
            }

            function resetPreviewImage() {
                menuPreviewImg.innerHTML = '';
                const defaultImage = document.createElement("img");
                defaultImage.src = "https://picsum.photos/600/800?random=1";
                menuPreviewImg.appendChild(defaultImage);
            }

            function animateMenuToggle(isOpening) {
                const open = document.querySelector("#menu-open");
                const close = document.querySelector("#menu-close");

                if (isOpening) {
                    ScrollSmoother.get().paused(true);
                    document.body.style.overflow = 'hidden';
                }
                else {
                    ScrollSmoother.get().paused(false);
                    document.body.style.overflow = '';
                }

                gsap.to(isOpening ? open : close, {
                    x: isOpening ? -5 : 5,
                    y: isOpening ? -10 : 10,
                    rotation: isOpening ? -5 : 5,
                    opacity: 0,
                    duration: .5,
                    delay: .5,
                    ease: "power2.out",
                });

                gsap.to(isOpening ? close : open, {
                    x: 0,
                    y: 0,
                    rotation: 0,
                    delay: .5,
                    opacity: 1,
                    duration: 0.5,
                    ease: "power2.out",
                });
            }

            function openMenu() {
                if (isAnimating || isOpen) return;
                isAnimating = true;

                gsap.to(container, {
                    x: 120,
                    y: 450,
                    scale: 1.5,
                    rotation: 10,
                    duration: .85,
                    delay: 0.1,
                    ease: "fastSlow",
                });

                animateMenuToggle(true);

                gsap.to(menuContent, {
                    rotation: 0,
                    x: 0,
                    y: 0,
                    scale: 1,
                    opacity: 1,
                    duration: .85,
                    ease: "fastSlow",
                });

                gsap.to([".link a", ".social a"], {
                    y: "0%",
                    opacity: 1,
                    delay: 0.55,
                    duration: 1.2,
                    stagger: 0.1,
                    ease: "power3.out",
                });

                gsap.to(menuOverlay, {
                    clipPath: "polygon(0 0, 100% 0, 100% 175%, 0 100%)",
                    duration: .85,
                    ease: "fastSlow",
                    onComplete: () => {
                        isOpen = true;
                        isAnimating = false;
                    }
                });

            }

            function closeMenu() {
                if (isAnimating || !isOpen) return;
                isAnimating = true;

                gsap.to(container, {
                    x: 0,
                    y: 0,
                    scale: 1,
                    rotation: 0,
                    duration: .85,
                    ease: "power4.inOut",
                });

                animateMenuToggle(false);

                gsap.to(menuContent, {
                    x: -100,
                    y: -100,
                    scale: 1.5,
                    rotation: -15,
                    opacity: 0.25,
                    duration: .85,
                    ease: "power4.inOut",
                });

                gsap.to(menuOverlay, {
                    clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)",
                    duration: .85,
                    ease: "power4.inOut",
                    onComplete: () => {
                        isOpen = false;
                        isAnimating = false;
                        gsap.set([".link a", ".social a"], {
                            y: "120%",
                        });
                        resetPreviewImage();
                    }
                });


            }

            menuLinks.forEach((link) => {
                // Event untuk hover gambar preview
                link.addEventListener("mouseover", () => {
                    if (!isOpen || isAnimating) return;

                    const imgSrc = link.getAttribute("data-img");
                    if (!imgSrc) return;

                    const previewImages = menuPreviewImg.querySelectorAll("img");
                    const currentImage = previewImages[previewImages.length - 1];

                    // Check if current image is same as hovered one
                    if (currentImage && currentImage.src.includes(imgSrc)) {
                        return;
                    }

                    // Create new image and preload it
                    const newImage = new Image();
                    newImage.src = imgSrc;

                    newImage.onload = () => {
                        // Add new image to DOM
                        newImage.style.opacity = "0";
                        newImage.style.transform = "scale(1.1) rotate(2deg)";
                        newImage.style.position = "absolute";
                        newImage.style.top = "0";
                        newImage.style.left = "0";
                        newImage.style.width = "100%";
                        newImage.style.height = "100%";
                        menuPreviewImg.appendChild(newImage);

                        // Animate old images out
                        previewImages.forEach((img) => {
                            gsap.to(img, {
                                opacity: 0,
                                scale: 0.95,
                                rotation: -2,
                                duration: 0.6,
                                ease: "power2.inOut",
                                stagger: 0.1
                            });
                        });

                        // Animate new image in
                        gsap.fromTo(newImage,
                            {
                                opacity: 0,
                                scale: 1.1,
                                rotation: 2
                            },
                            {
                                opacity: 1,
                                scale: 1,
                                rotation: 0,
                                duration: 0.8,
                                ease: "power2.out",
                                onComplete: () => {
                                    cleanupPreviewImage();
                                }
                            }
                        );
                    };
                });

                link.addEventListener("click", (e) => {
                    if (!isOpen || isAnimating) return;

                    e.preventDefault(); // Prevent default for all links
                    const href = link.getAttribute("href");

                    // Close menu first
                    closeMenu();

                    if (href) {
                        if (href.startsWith("#")) {
                            // For internal hash links
                            setTimeout(() => {
                                const targetElement = document.querySelector(href);
                                if (targetElement) {
                                    targetElement.scrollIntoView({
                                        behavior: 'smooth'
                                    });
                                }
                            }, 500);
                        } else {
                            // For external page navigation
                            window.scrollTo({
                                top: 0,
                                behavior: 'smooth'
                            });

                            setTimeout(() => {
                                window.location.href = href;
                            }, 1200);
                        }
                    }
                });
            });
            navLinks.forEach((link) => {
                link.addEventListener("click", (e) => {
                    if (!isOpen || isAnimating) return;

                    e.preventDefault(); // Prevent default for all links
                    const href = link.getAttribute("href");

                    // Close menu first
                    closeMenu();

                    if (href) {
                        if (href.startsWith("#")) {
                            // For internal hash links
                            setTimeout(() => {
                                const targetElement = document.querySelector(href);
                                if (targetElement) {
                                    targetElement.scrollIntoView({
                                        behavior: 'smooth'
                                    });
                                }
                            }, 500);
                        } else {
                            // For external page navigation
                            window.scrollTo({
                                top: 0,
                                behavior: 'smooth'
                            });

                            setTimeout(() => {
                                window.location.href = href;
                            }, 1200);
                        }
                    }
                });
            });

        });
    </script>
</body>

</html>