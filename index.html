<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="particles"></div>
    <div class="background_custom">
        <div class="svg_body_bg">
            <div class="circle_lg">
                <!-- Fixed: Made viewBox square (797x797) to match width/height -->
                <svg width="797" height="797" viewBox="0 0 797 797" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g filter="url(#filter0_f_135_244)">
                        <circle cx="398.5" cy="398.5" r="181.958" fill="#FEE193" />
                    </g>
                    <defs>
                        <filter id="filter0_f_135_244" x="0" y="0" width="797" height="797" filterUnits="userSpaceOnUse"
                            color-interpolation-filters="sRGB">
                            <feFlood flood-opacity="0" result="BackgroundImageFix" />
                            <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape" />
                            <feGaussianBlur stdDeviation="108" result="effect1_foregroundBlur_135_244" />
                        </filter>
                    </defs>
                </svg>
            </div>

            <div class="circle_sm">
                <!-- Fixed: Made it a perfect circle by using same radius for both rx and ry -->
                <svg width="510" height="510" viewBox="0 0 510 510" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g filter="url(#filter0_f_135_246)">
                        <!-- Changed ellipse to circle with consistent radius -->
                        <circle cx="255" cy="255" r="130" fill="#B8E0D8" />
                    </g>
                    <defs>
                        <filter id="filter0_f_135_246" x="0" y="0" width="510" height="510" filterUnits="userSpaceOnUse"
                            color-interpolation-filters="sRGB">
                            <feFlood flood-opacity="0" result="BackgroundImageFix" />
                            <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape" />
                            <feGaussianBlur stdDeviation="60" result="effect1_foregroundBlur_135_246" />
                        </filter>
                    </defs>
                </svg>
            </div>
        </div>
    </div>

    <nav>
        <div class="logo">
            <a href="#">NakoClass</a>
        </div>
        <div class="nav-links">
            <ul>
                <li><a href="home.html">Home</a></li>
                <li><a href="navbar_gsap_update.html">Cara Menggambar</a></li>
                <li><a href="referensi.html">Referensi</a></li>
                <li><a href="toko.html">Toko</a></li>
            </ul>
        </div>
        <div class="menu-toggle">
            <p id="menu-open">Menu</p>
            <p id="menu-close">Close</p>
        </div>
    </nav>

    <div class="menu-overlay">
        <div class="menu-content">
            <div class="menu-items">
                <div class="col-lg">
                    <div class="menu-preview-img">
                        <img src="4.png" alt="">
                    </div>
                </div>
                <div class="col-sm">
                    <div class="menu-links">
                        <div class="link">
                            <a href="home.html" data-img="1.jpg">Home</a>
                        </div>
                        <div class="link">
                            <a href="navbar_gsap_update.html" data-img="wp5.jpg">Cara Menggambar</a>
                        </div>
                        <div class="link">
                            <a href="referensi.html" data-img="wp6.jpg">Referensi</a>
                        </div>
                        <div class="link">
                            <a href="toko.html" data-img="3.jpg">Toko</a>
                        </div>
                    </div>
                    <div class="menu-socials">
                        <div class="social">
                            <a href="#">Instagram</a>
                        </div>
                        <div class="social">
                            <a href="#">WhatsApp</a>
                        </div>
                        <div class="social">
                            <a href="#">LinkedIn</a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div class="menu-footer">
                <div class="col-lg">
                    <a href="#">Testing</a>
                </div>
                <div class="col-sm">
                    <a href="#">Origin</a>
                    <a href="#">Join Signal</a>
                </div>
            </div> -->
        </div>
    </div>

    <!-- Splashscreen -->
    <!-- <div class="splash_screen">
        <div class="splash-content">
            <span>N</span>
            <span>A</span>
            <span>K</span>
            <span>O</span>
            <span>C</span>
            <span>L</span>
            <span>A</span>
            <span>S</span>
            <span>S</span>
        </div>
        <svg class="splash-svg" viewBox="0 0 1440 420" preserveAspectRatio="none" width="1440" height="420">
            <path id="curve" d="M0,0 Q820,820 1440,0 L1440,-280 L0,-280 Z" fill="#000" />
        </svg>
    </div> -->

    <!-- Main Contant -->
    <div id="smooth-wrapper" class="container">

        <div id="smooth-content">
            <section id="home" class="hero">
                <!-- <div class="hero-img">
                    <img src="https://a.storyblok.com/f/133769/1920x2716/5c24d6b467/exo-ape-hero-1.jpg/m/2400x3395/filters:quality(90)"
                        alt="">
                </div> -->
                <div class="box-title">
                    <h1>Master the art of drawing <br> Manga step by step</h1>
                    <span>マンガの描き方を基本から上達まで学ぼう</span>
                </div>
            </section>

            <!-- content 1 -->
            <section class="body-content">
                <div class="box_tutor" data-video="video_1.webm">

                    <div class="box_text box_text_left">
                        <div class="box_title">
                            <span class="title">
                                Dasar Dasar Menggambar Manga
                            </span>
                        </div>
                        <div class="box_description">
                            <span class="description">
                                Mengenal alat dan teknik dasar dalam menggambar manga. Pelajari cara membuat garis yang
                                tepat
                                dan
                                penggunaan pensil yang benar
                            </span>
                        </div>
                        <div class="box_jpn">
                            <span class="jpn">
                                漫画の基本を学ぶ
                            </span>
                        </div>
                    </div>

                    <div class="box_img">
                        <div class="img_thum">
                            <video muted autoplay playsinline loop>
                                <source src="thumbnail.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="border_img">
                            <img src="images/border_frame.svg" alt="">
                        </div>
                        <div class="play_btn">
                        </div>
                        <div class="loading-spinner" style="display: none;"></div>
                    </div>
                    <div class="char_img char_right">
                        <img width="300" height="300" src="images/anime.png" alt="">
                    </div>
                </div>
            </section>

            <!-- content 2 -->
            <section class="body-content">
                <div class="box_tutor" data-video="thumbnail.mp4">

                    <div class="box_img">
                        <div class="img_thum">
                            <video muted autoplay playsinline loop>
                                <source src="thumbnail.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="border_img">
                            <img src="images/border_frame.svg" alt="">
                        </div>
                        <div class="play_btn">
                        </div>
                        <div class="loading-spinner" style="display: none;"></div>
                    </div>
                    <div class="char_img">
                        <img width="300" height="300" src="images/anime.png" alt="">
                    </div>
                    <div class="box_text">
                        <div class="box_title">
                            <span class="title">
                                Dasar Dasar Menggambar Manga
                            </span>
                        </div>
                        <div class="box_description">
                            <span class="description">
                                Mengenal alat dan teknik dasar dalam menggambar manga. Pelajari cara membuat garis yang
                                tepat
                                dan
                                penggunaan pensil yang benar
                            </span>
                        </div>
                        <div class="box_jpn">
                            <span class="jpn">
                                漫画の基本を学ぶ
                            </span>
                        </div>
                    </div>
                </div>

            </section>

            <!-- content 3 -->
            <section class="body-content">
                <div class="box_tutor" data-video="video_1.webm">

                    <div class="box_text box_text_left">
                        <div class="box_title">
                            <span class="title">
                                Dasar Dasar Menggambar Manga
                            </span>
                        </div>
                        <div class="box_description">
                            <span class="description">
                                Mengenal alat dan teknik dasar dalam menggambar manga. Pelajari cara membuat garis yang
                                tepat
                                dan
                                penggunaan pensil yang benar
                            </span>
                        </div>
                        <div class="box_jpn">
                            <span class="jpn">
                                漫画の基本を学ぶ
                            </span>
                        </div>
                    </div>

                    <div class="box_img">
                        <div class="img_thum">
                            <video muted autoplay playsinline loop>
                                <source src="thumbnail.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="border_img">
                            <img src="images/border_frame.svg" alt="">
                        </div>
                        <div class="play_btn">
                        </div>
                        <div class="loading-spinner" style="display: none;"></div>
                    </div>
                    <div class="char_img char_right">
                        <img width="300" height="300" src="images/anime.png" alt="">
                    </div>
                </div>
            </section>

            <!-- content 4 -->
            <section class="body-content">
                <div class="box_tutor" data-video="thumbnail.mp4">

                    <div class="box_img">
                        <div class="img_thum">
                            <video muted autoplay playsinline loop>
                                <source src="thumbnail.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="border_img">
                            <img src="images/border_frame.svg" alt="">
                        </div>
                        <div class="play_btn">
                        </div>
                        <div class="loading-spinner" style="display: none;"></div>
                    </div>
                    <div class="char_img">
                        <img width="300" height="300" src="images/anime.png" alt="">
                    </div>
                    <div class="box_text">
                        <div class="box_title">
                            <span class="title">
                                Dasar Dasar Menggambar Manga
                            </span>
                        </div>
                        <div class="box_description">
                            <span class="description">
                                Mengenal alat dan teknik dasar dalam menggambar manga. Pelajari cara membuat garis yang
                                tepat
                                dan
                                penggunaan pensil yang benar
                            </span>
                        </div>
                        <div class="box_jpn">
                            <span class="jpn">
                                漫画の基本を学ぶ
                            </span>
                        </div>
                    </div>
                </div>

            </section>

            <!-- content 5 -->
            <section class="body-content">
                <div class="box_tutor" data-video="video_1.webm">

                    <div class="box_text box_text_left">
                        <div class="box_title">
                            <span class="title">
                                Dasar Dasar Menggambar Manga
                            </span>
                        </div>
                        <div class="box_description">
                            <span class="description">
                                Mengenal alat dan teknik dasar dalam menggambar manga. Pelajari cara membuat garis yang
                                tepat
                                dan
                                penggunaan pensil yang benar
                            </span>
                        </div>
                        <div class="box_jpn">
                            <span class="jpn">
                                漫画の基本を学ぶ
                            </span>
                        </div>
                    </div>

                    <div class="box_img">
                        <div class="img_thum">
                            <video muted autoplay playsinline loop>
                                <source src="thumbnail.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="border_img">
                            <img src="images/border_frame.svg" alt="">
                        </div>
                        <div class="play_btn">
                        </div>
                        <div class="loading-spinner" style="display: none;"></div>
                    </div>
                    <div class="char_img char_right">
                        <img width="300" height="300" src="images/anime.png" alt="">
                    </div>
                </div>
            </section>

            <!-- content 6 -->
            <section class="body-content">
                <div class="box_tutor" data-video="thumbnail.mp4">

                    <div class="box_img">
                        <div class="img_thum">
                            <video muted autoplay playsinline loop>
                                <source src="thumbnail.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="border_img">
                            <img src="images/border_frame.svg" alt="">
                        </div>
                        <div class="play_btn">
                        </div>
                        <div class="loading-spinner" style="display: none;"></div>
                    </div>
                    <div class="char_img">
                        <img width="300" height="300" src="images/anime.png" alt="">
                    </div>
                    <div class="box_text">
                        <div class="box_title">
                            <span class="title">
                                Dasar Dasar Menggambar Manga
                            </span>
                        </div>
                        <div class="box_description">
                            <span class="description">
                                Mengenal alat dan teknik dasar dalam menggambar manga. Pelajari cara membuat garis yang
                                tepat
                                dan
                                penggunaan pensil yang benar
                            </span>
                        </div>
                        <div class="box_jpn">
                            <span class="jpn">
                                漫画の基本を学ぶ
                            </span>
                        </div>
                    </div>
                </div>

            </section>

            <!-- content 7 -->
            <section class="body-content">
                <div class="box_tutor" data-video="video_1.webm">

                    <div class="box_text box_text_left">
                        <div class="box_title">
                            <span class="title">
                                Dasar Dasar Menggambar Manga
                            </span>
                        </div>
                        <div class="box_description">
                            <span class="description">
                                Mengenal alat dan teknik dasar dalam menggambar manga. Pelajari cara membuat garis yang
                                tepat
                                dan
                                penggunaan pensil yang benar
                            </span>
                        </div>
                        <div class="box_jpn">
                            <span class="jpn">
                                漫画の基本を学ぶ
                            </span>
                        </div>
                    </div>

                    <div class="box_img">
                        <div class="img_thum">
                            <video muted autoplay playsinline loop>
                                <source src="thumbnail.mp4" type="video/mp4">
                            </video>
                        </div>
                        <div class="border_img">
                            <img src="images/border_frame.svg" alt="">
                        </div>
                        <div class="play_btn">
                        </div>
                        <div class="loading-spinner" style="display: none;"></div>
                    </div>
                    <div class="char_img char_right">
                        <img width="300" height="300" src="images/anime.png" alt="">
                    </div>
                </div>
            </section>

            <section class="video-modal-overlay" id="videoModal">
                <div class="video-modal-container" id="videoContainer">
                    <button class="close-btn" id="closeBtn"></button>
                    <div class="video-wrapper">
                        <video id="mainVideo" playsinline>
                            <source src="" type="video/webm">
                            <source src="" type="video/mp4">
                        </video>
                        <div class="video-controls">
                            <button class="control-btn" id="playPauseBtn">
                                <span class="tooltip">Play/Pause</span>
                                ▶
                            </button>
                            <div class="progress-bar" id="progressBar">
                                <div class="progress-bar-fill" id="progressFill"></div>
                            </div>
                            <button class="control-btn" id="muteBtn">
                                <span class="tooltip">Mute/Unmute</span>
                                🔊
                            </button>
                            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.1"
                                value="1">
                            <button class="control-btn" id="fullscreenBtn">
                                <span class="tooltip">Fullscreen</span>
                                ⛶
                            </button>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/CustomEase.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.13.0/ScrollSmoother.min.js"
        integrity="sha512-t4hwZimhnCKT3YLAsEcAcRDkngVFfCcUIfNLIjklrIZAZKD+GfQMP7HbRcsVHxNS48WRBSywNU1uSM2zzLQt1Q=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>

        gsap.registerPlugin(CustomEase, ScrollSmoother, ScrollTrigger);
        CustomEase.create("fastSlow", "M0,0 C0.83,0 0.17,1 1,1");

        document.addEventListener("DOMContentLoaded", () => {
            new MainScript();
        });

        class MainScript {
            constructor() {
                this.init();
            }

            init() {
                new CoreScript();
                new AnimatedVariant();
                new AdvancedVideoPlayer();
                new ScrollAnimationManager();
            }
        }

        // Core Script
        class CoreScript {
            constructor() {
                this.init();
            }

            init() {
                // Smooth Scrolling
                ScrollSmoother.create({
                    wrapper: "#smooth-wrapper",
                    content: "#smooth-content",
                    smooth: 2.2,
                    effects: true,
                    smoothTouch: 0.1,
                    normalizeScroll: true,
                    ignoreMobileResize: true,
                });

                // Splashscreen Animation
                // window.addEventListener('load', () => {
                //     window.scrollTo({
                //         top: 0,
                //         behavior: 'smooth'
                //     });

                //     const splashScreen = document.querySelector('.splash_screen');
                //     const containers = document.querySelectorAll('.container');
                //     const textSpans = document.querySelectorAll('.splash-content span');

                //     document.body.style.overflowY = 'hidden';
                //     document.documentElement.style.overflowY = 'hidden';

                //     document.body.style.overflowX = 'hidden';
                //     document.documentElement.style.overflowX = 'hidden';

                //     // Create timeline for synchronized animation
                //     let tl = gsap.timeline();

                //     tl.to(textSpans, {
                //         y: "0%",
                //         opacity: 1,
                //         delay: 0.4,
                //         duration: .7,
                //         stagger: 0.1,
                //         ease: "power3.out",
                //     }).to(splashScreen, {
                //         duration: .7,
                //         y: '-100%',
                //         position: 'relative',
                //         opacity: 1,
                //         // delay: 1.0,
                //         ease: 'power2.inOut',
                //         stagger: 0,
                //         onComplete: () => {
                //             splashScreen.style.display = 'none';
                //             document.body.style.overflowY = 'auto';
                //             document.documentElement.style.overflowY = 'auto';

                //             document.body.style.overflowX = 'hidden';
                //             document.documentElement.style.overflowX = 'hidden';

                //             // Reset container positions
                //             containers.forEach(container => {
                //                 container.style.transform = 'none';
                //             });
                //         }
                //     }).to("#curve", {
                //         duration: .6,
                //         ease: "power4.inOut",
                //         attr: {
                //             d: "M0,0 Q820,0 1440,0 L1440,-280 L0,-280 Z"
                //         }
                //     }, "-=.5");
                // });

                // Background Animation
                const movementRadius = 120;

                function randomInRange(min, max) {
                    return Math.random() * (max - min) + min;
                }

                function animateCircle(selector, baseScale = 0.8, delay = 0) {
                    function move() {
                        const x = randomInRange(-movementRadius, movementRadius);
                        const y = randomInRange(-movementRadius, movementRadius);
                        // Fixed: Use consistent scale range that maintains circle shape
                        const scale = randomInRange(baseScale * 0.9, baseScale * 1.1);

                        gsap.to(selector, {
                            duration: 2,
                            x,
                            y,
                            scale: scale, // Single scale value maintains perfect circle
                            ease: "sine.inOut",
                            onComplete: move,
                            delay
                        });
                    }
                    move();
                }

                // Large circle animation with more stable scaling
                animateCircle(".circle_lg", 0.6);

                // Small circle animation with delay
                animateCircle(".circle_sm", 0.5, 0.2);
            }

        }

        // Animated Variant
        class AnimatedVariant {
            constructor() {
                this.initAnimations();
            }
            initAnimations() {
                // Navigation Bar Animation
                ScrollTrigger.create({
                    trigger: "body",
                    start: "top -100px",
                    end: "bottom bottom",
                    onEnter: () => {
                        // NavLinks hilang 
                        gsap.to(".nav-links", {
                            clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)",
                            duration: 0.5,
                            ease: "power2.in",
                            onComplete: () => {
                                gsap.set(".nav-links", { display: "none" });
                            }
                        });

                        // MenuToggle 
                        gsap.set(".menu-toggle", {
                            display: "block",
                            delay: 0.5,
                            clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)"
                        });
                        gsap.to(".menu-toggle", {
                            clipPath: "polygon(0 0, 100% 0, 100% 100%, 0 100%)",
                            opacity: 1,
                            duration: 0.6,
                            ease: "power3.out",
                            delay: 0.8
                        });
                    },
                    onLeaveBack: () => {
                        // MenuToggle hilang
                        gsap.to(".menu-toggle", {
                            clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)",
                            opacity: 0,
                            duration: 0.5,
                            ease: "power2.in",
                            onComplete: () => {
                                gsap.set(".menu-toggle", { display: "none" });
                            }
                        });

                        // NavLinks muncul kembali dengan clip-path
                        gsap.set(".nav-links", {
                            display: "block",
                            delay: 0.5,
                            clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)"
                        });
                        gsap.to(".nav-links", {
                            clipPath: "polygon(0 0, 100% 0, 100% 100%, 0 100%)",
                            duration: 0.6,
                            ease: "power3.out",
                            delay: 0.8
                        });
                    }
                });

                // Navigation Menu
                const container = document.querySelector(".container");
                const menuToggle = document.querySelector(".menu-toggle");
                const menuOverlay = document.querySelector(".menu-overlay");
                const menuContent = document.querySelector(".menu-content");
                const menuPreviewImg = document.querySelector(".menu-preview-img");
                const menuLinks = document.querySelectorAll(".link a");
                const navLinks = document.querySelectorAll(".nav-links a");

                let isOpen = false;
                let isAnimating = false;

                menuToggle.addEventListener("click", () => {
                    if (!isOpen) openMenu();
                    else closeMenu();
                });

                function cleanupPreviewImage() {
                    const previewImages = menuPreviewImg.querySelectorAll("img");
                    if (previewImages.length > 3) {
                        for (let i = 0; i < previewImages.length - 3; i++) {
                            menuPreviewImg.removeChild(previewImages[i]);
                        }
                    }
                }

                function resetPreviewImage() {
                    menuPreviewImg.innerHTML = '';
                    const defaultImage = document.createElement("img");
                    defaultImage.src = "https://picsum.photos/600/800?random=1";
                    menuPreviewImg.appendChild(defaultImage);
                }

                function animateMenuToggle(isOpening) {
                    const open = document.querySelector("#menu-open");
                    const close = document.querySelector("#menu-close");

                    if (isOpening) {
                        ScrollSmoother.get().paused(true);
                        document.body.style.overflow = 'hidden';
                    }
                    else {
                        ScrollSmoother.get().paused(false);
                        document.body.style.overflow = '';
                    }

                    gsap.to(isOpening ? open : close, {
                        x: isOpening ? -5 : 5,
                        y: isOpening ? -10 : 10,
                        rotation: isOpening ? -5 : 5,
                        opacity: 0,
                        duration: .5,
                        delay: .5,
                        ease: "power2.out",
                    });

                    gsap.to(isOpening ? close : open, {
                        x: 0,
                        y: 0,
                        rotation: 0,
                        delay: .5,
                        opacity: 1,
                        duration: 0.5,
                        ease: "power2.out",
                    });
                }

                function openMenu() {
                    if (isAnimating || isOpen) return;
                    isAnimating = true;

                    gsap.to(container, {
                        x: 120,
                        y: 450,
                        scale: 1.5,
                        rotation: 10,
                        duration: .85,
                        delay: 0.1,
                        ease: "fastSlow",
                    });

                    animateMenuToggle(true);

                    gsap.to(menuContent, {
                        rotation: 0,
                        x: 0,
                        y: 0,
                        scale: 1,
                        opacity: 1,
                        duration: .85,
                        ease: "fastSlow",
                    });

                    gsap.to([".link a", ".social a"], {
                        y: "0%",
                        opacity: 1,
                        delay: 0.55,
                        duration: 1.2,
                        stagger: 0.1,
                        ease: "power3.out",
                    });

                    gsap.to(menuOverlay, {
                        clipPath: "polygon(0 0, 100% 0, 100% 175%, 0 100%)",
                        duration: .85,
                        ease: "fastSlow",
                        onComplete: () => {
                            isOpen = true;
                            isAnimating = false;
                        }
                    });

                }

                function closeMenu() {
                    if (isAnimating || !isOpen) return;
                    isAnimating = true;

                    gsap.to(container, {
                        x: 0,
                        y: 0,
                        scale: 1,
                        rotation: 0,
                        duration: .85,
                        ease: "power4.inOut",
                    });

                    animateMenuToggle(false);

                    gsap.to(menuContent, {
                        x: -100,
                        y: -100,
                        scale: 1.5,
                        rotation: -15,
                        opacity: 0.25,
                        duration: .85,
                        ease: "power4.inOut",
                    });

                    gsap.to(menuOverlay, {
                        clipPath: "polygon(0 0, 100% 0, 100% 0%, 0 0%)",
                        duration: .85,
                        ease: "power4.inOut",
                        onComplete: () => {
                            isOpen = false;
                            isAnimating = false;
                            gsap.set([".link a", ".social a"], {
                                y: "120%",
                            });
                            resetPreviewImage();
                        }
                    });


                }

                menuLinks.forEach((link) => {
                    // Event untuk hover gambar preview
                    link.addEventListener("mouseover", () => {
                        if (!isOpen || isAnimating) return;

                        const imgSrc = link.getAttribute("data-img");
                        if (!imgSrc) return;

                        const previewImages = menuPreviewImg.querySelectorAll("img");
                        const currentImage = previewImages[previewImages.length - 1];

                        // Check if current image is same as hovered one
                        if (currentImage && currentImage.src.includes(imgSrc)) {
                            return;
                        }

                        // Create new image and preload it
                        const newImage = new Image();
                        newImage.src = imgSrc;

                        newImage.onload = () => {
                            // Add new image to DOM
                            newImage.style.opacity = "0";
                            newImage.style.transform = "scale(1.1) rotate(2deg)";
                            newImage.style.position = "absolute";
                            newImage.style.top = "0";
                            newImage.style.left = "0";
                            newImage.style.width = "100%";
                            newImage.style.height = "100%";
                            menuPreviewImg.appendChild(newImage);

                            // Animate old images out
                            previewImages.forEach((img) => {
                                gsap.to(img, {
                                    opacity: 0,
                                    scale: 0.95,
                                    rotation: -2,
                                    duration: 0.6,
                                    ease: "power2.inOut",
                                    stagger: 0.1
                                });
                            });

                            // Animate new image in
                            gsap.fromTo(newImage,
                                {
                                    opacity: 0,
                                    scale: 1.1,
                                    rotation: 2
                                },
                                {
                                    opacity: 1,
                                    scale: 1,
                                    rotation: 0,
                                    duration: 0.8,
                                    ease: "power2.out",
                                    onComplete: () => {
                                        cleanupPreviewImage();
                                    }
                                }
                            );
                        };
                    });

                    link.addEventListener("click", (e) => {
                        if (!isOpen || isAnimating) return;

                        e.preventDefault(); // Prevent default for all links
                        const href = link.getAttribute("href");

                        // Close menu first
                        closeMenu();

                        if (href) {
                            if (href.startsWith("#")) {
                                // For internal hash links
                                setTimeout(() => {
                                    const targetElement = document.querySelector(href);
                                    if (targetElement) {
                                        targetElement.scrollIntoView({
                                            behavior: 'smooth'
                                        });
                                    }
                                }, 500);
                            } else {
                                // For external page navigation
                                window.scrollTo({
                                    top: 0,
                                    behavior: 'smooth'
                                });

                                setTimeout(() => {
                                    window.location.href = href;
                                }, 1200);
                            }
                        }
                    });
                });
                navLinks.forEach((link) => {
                    link.addEventListener("click", (e) => {
                        if (!isOpen || isAnimating) return;

                        e.preventDefault(); // Prevent default for all links
                        const href = link.getAttribute("href");

                        // Close menu first
                        closeMenu();

                        if (href) {
                            if (href.startsWith("#")) {
                                // For internal hash links
                                setTimeout(() => {
                                    const targetElement = document.querySelector(href);
                                    if (targetElement) {
                                        targetElement.scrollIntoView({
                                            behavior: 'smooth'
                                        });
                                    }
                                }, 500);
                            } else {
                                // For external page navigation
                                window.scrollTo({
                                    top: 0,
                                    behavior: 'smooth'
                                });

                                setTimeout(() => {
                                    window.location.href = href;
                                }, 1200);
                            }
                        }
                    });
                });
            }
        }

        class AdvancedVideoPlayer {
            constructor() {
                this.currentVideo = null;
                this.modal = document.getElementById('videoModal');
                this.container = document.getElementById('videoContainer');
                this.video = document.getElementById('mainVideo');
                this.playPauseBtn = document.getElementById('playPauseBtn');
                this.progressBar = document.getElementById('progressBar');
                this.progressFill = document.getElementById('progressFill');
                this.muteBtn = document.getElementById('muteBtn');
                this.volumeSlider = document.getElementById('volumeSlider');
                this.fullscreenBtn = document.getElementById('fullscreenBtn');
                this.closeBtn = document.getElementById('closeBtn');

                this.isOpen = false;
                this.scrollPosition = 0;

                this.init();
                this.createParticles();
            }

            init() {
                // Tambahkan event listener untuk semua tombol play
                document.querySelectorAll('.box_img').forEach(box => {
                    box.addEventListener('click', (e) => {
                        const videoSrc = box.closest('.box_tutor').dataset.video;
                        this.openVideo(videoSrc, box);
                    });
                });

                // Kontrol video
                this.playPauseBtn.addEventListener('click', () => this.togglePlayPause());
                this.muteBtn.addEventListener('click', () => this.toggleMute());
                this.volumeSlider.addEventListener('input', () => this.setVolume());
                this.fullscreenBtn.addEventListener('click', () => this.toggleFullscreen());
                this.closeBtn.addEventListener('click', () => this.closeVideo());

                // Progress bar
                this.progressBar.addEventListener('click', (e) => this.setProgress(e));
                this.video.addEventListener('timeupdate', () => this.updateProgress());
                this.video.addEventListener('loadedmetadata', () => this.updateProgress());

                // Klik overlay modal untuk menutup
                this.modal.addEventListener('click', (e) => {
                    if (e.target === this.modal) {
                        this.closeVideo();
                    }
                });

                // Kontrol keyboard
                document.addEventListener('keydown', (e) => {
                    if (this.modal.classList.contains('active')) {
                        switch (e.code) {
                            case 'Space':
                                e.preventDefault();
                                this.togglePlayPause();
                                break;
                            case 'Escape':
                                this.closeVideo();
                                break;
                            case 'KeyF':
                                this.toggleFullscreen();
                                break;
                            case 'KeyM':
                                this.toggleMute();
                                break;
                        }
                    }
                });

                // Event video
                this.video.addEventListener('ended', () => {
                    this.playPauseBtn.textContent = '▶';
                });

                this.video.addEventListener('play', () => {
                    this.playPauseBtn.textContent = '⏸';
                });

                this.video.addEventListener('pause', () => {
                    this.playPauseBtn.textContent = '▶';
                });
            }

            // Fungsi untuk menghitung lebar scrollbar
            getScrollbarWidth() {
                // Buat elemen div sementara untuk mengukur scrollbar
                const outer = document.createElement('div');
                outer.style.visibility = 'hidden';
                outer.style.overflow = 'scroll'; // Memaksa scrollbar muncul
                document.body.appendChild(outer);

                const inner = document.createElement('div');
                outer.appendChild(inner);

                const scrollbarWidth = outer.offsetWidth - inner.offsetWidth;
                outer.parentNode.removeChild(outer); // Hapus elemen sementara

                return scrollbarWidth;
            } async openVideo(videoSrc, thumbnailElement) {
                try {
                    if (this.isOpen) return;

                    // Store viewport position
                    const viewportY = window.scrollY;

                    // Get ScrollSmoother instance
                    const smoother = ScrollSmoother.get();
                    if (smoother) {
                        this.smoothProgress = smoother.scrollTrigger.progress;
                        this.scrollPosition = smoother.scrollTop();
                        smoother.paused(true);
                    }

                    // Lock scroll and add modal classes
                    document.documentElement.classList.add('modal-open');
                    document.body.classList.add('modal-open');                    // Show modal
                    this.modal.classList.add('active');

                    // Position modal container at viewport center
                    this.container.style.top = `${viewportY + (window.innerHeight / 2)}px`;

                    // Get spinner element
                    let spinner = thumbnailElement.querySelector('.loading-spinner');
                    if (!spinner) {
                        spinner = document.createElement('div');
                        spinner.className = 'loading-spinner';
                        thumbnailElement.appendChild(spinner);
                    }
                    spinner.style.display = 'block';

                    // Set up video sources
                    this.video.innerHTML = `
                        <source src="${videoSrc}" type="video/webm">
                        <source src="${videoSrc.replace('.webm', '.mp4')}" type="video/mp4">
                    `; this.video.load();

                    // Wait for video to be ready
                    await new Promise((resolve) => {
                        this.video.addEventListener('canplay', resolve, { once: true });
                    });

                    this.isOpen = true;

                    // Show and animate modal
                    this.modal.classList.add('active');                    // Use GSAP for smooth animation with proper timing
                    gsap.fromTo(this.container,
                        {
                            scale: 0.8,
                            opacity: 0
                        },
                        {
                            scale: 1,
                            opacity: 1,
                            y: 0,
                            duration: 0.4,
                            ease: "expo.out",
                            onComplete: () => {
                                // Hide loading spinner and play video
                                spinner.style.display = 'none';
                                this.video.play();
                            }
                        }
                    );

                } catch (error) {
                    console.error('Error loading video:', error);
                    spinner.style.display = 'none';
                    this.closeVideo();
                }
            } closeVideo() {
                if (!this.isOpen) return;
                this.isOpen = false;

                // Get ScrollSmoother instance
                const smoother = ScrollSmoother.get();

                // Stop video playback
                this.video.pause();

                // Animate modal out
                gsap.to(this.container, {
                    scale: 0.8,
                    opacity: 0,
                    y: 20,
                    duration: 0.3,
                    ease: "power2.in",
                    onComplete: () => {
                        // Clean up video and modal state
                        this.modal.classList.remove('active');
                        this.video.removeAttribute('src');
                        this.video.load();

                        // Remove scroll lock classes and padding
                        document.documentElement.classList.remove('modal-open');
                        document.body.classList.remove('modal-open');
                        document.body.style.paddingRight = '';                        // Restore ScrollSmoother state and position
                        if (smoother) {
                            smoother.paused(false);
                            requestAnimationFrame(() => {
                                smoother.scrollTo(this.scrollPosition, {
                                    duration: 0,
                                    ease: "none"
                                });
                            });
                        }
                    }
                });
            }

            togglePlayPause() {
                if (this.video.paused) {
                    this.video.play();
                } else {
                    this.video.pause();
                }
            }

            toggleMute() {
                this.video.muted = !this.video.muted;
                this.muteBtn.textContent = this.video.muted ? '🔇' : '🔊';
                this.volumeSlider.value = this.video.muted ? 0 : this.video.volume;
            }

            setVolume() {
                this.video.volume = this.volumeSlider.value;
                this.video.muted = this.volumeSlider.value === '0';
                this.muteBtn.textContent = this.video.muted ? '🔇' : '🔊';
            }

            setProgress(e) {
                const rect = this.progressBar.getBoundingClientRect();
                const pos = (e.clientX - rect.left) / rect.width;
                this.video.currentTime = pos * this.video.duration;
            }

            updateProgress() {
                if (this.video.duration) {
                    const progress = (this.video.currentTime / this.video.duration) * 100;
                    this.progressFill.style.width = progress + '%';
                }
            }

            toggleFullscreen() {
                if (!document.fullscreenElement) {
                    this.modal.requestFullscreen();
                    this.fullscreenBtn.textContent = '⛉';
                } else {
                    document.exitFullscreen();
                    this.fullscreenBtn.textContent = '⛶';
                }
            }

            createParticles() {
                const particlesContainer = document.querySelector('.particles');
                const particleCount = 50;

                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.classList.add('particle');

                    // Posisi random
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.top = Math.random() * 100 + '%';

                    particlesContainer.appendChild(particle);

                    // Animasi partikel dengan GSAP
                    gsap.to(particle, {
                        y: -Math.random() * 500 - 100,
                        x: (Math.random() - 0.5) * 200,
                        opacity: 0,
                        duration: Math.random() * 3 + 2,
                        ease: "power1.out",
                        repeat: -1,
                        delay: Math.random() * 2
                    });
                }
            }
        }

        // Sistem animasi scroll modern dengan timeline berurutan
        class ScrollAnimationManager {
            constructor() {
                this.initScrollAnimations();
            }

            initScrollAnimations() {
                document.querySelectorAll('.box_tutor').forEach((tutorBox, index) => {
                    const mainTimeline = gsap.timeline({ paused: true });

                    mainTimeline.fromTo(tutorBox, {
                        opacity: 0,
                        y: 100
                    }, {
                        opacity: 1,
                        y: 0,
                        duration: 0.7,
                        ease: "power2.out"
                    });

                    const textTimeline = gsap.timeline({ paused: true, });

                    const charImg = tutorBox.querySelector('.char_img img');
                    if (charImg) {
                        textTimeline.fromTo(charImg,
                            {
                                x: -100,
                                opacity: 0,
                                rotation: -10
                            },
                            {
                                x: 0,
                                opacity: 1,
                                rotation: 0,
                                duration: 1,
                                ease: "elastic.out(1, 0.5)",
                            }
                        );
                    }

                    const title = tutorBox.querySelector('.box_text .box_title .title');
                    if (title) {
                        textTimeline.fromTo(title, {
                            y: '100%',
                            opacity: 0
                        }, {
                            y: '0%',
                            opacity: 1,
                            duration: 0.6,
                            ease: "power2.out"
                        }, 0.2);
                    }

                    const description = tutorBox.querySelector('.box_text .box_description .description');
                    if (description) {
                        textTimeline.fromTo(description, {
                            y: '100%',
                            opacity: 0
                        }, {
                            y: '0%',
                            opacity: 1,
                            duration: 0.6,
                            ease: "power2.out"
                        }, 0.4);
                    }

                    const jpnText = tutorBox.querySelector('.box_text .box_jpn .jpn');
                    if (jpnText) {
                        textTimeline.fromTo(jpnText, {
                            y: '100%',
                            opacity: 0
                        }, {
                            y: '0%',
                            opacity: 1,
                            duration: 0.6,
                            ease: "power2.out"
                        }, 0.6);
                    }

                    ScrollTrigger.create({
                        trigger: tutorBox,
                        start: "top 90%",
                        onEnter: () => {
                            mainTimeline.play();
                            textTimeline.play();
                        }
                    });
                });
            }
        }

    </script>
</body>

</html>